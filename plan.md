# Flutter + Shadcn å°è¯´é˜…è¯»å™¨é‡æ„è®¡åˆ’ï¼ˆå‚è€ƒ legadoï¼‰

## 1. é¡¹ç›®ç›®æ ‡

- åœ¨å½“å‰ç›®å½•ä»é›¶é‡å»ºä¸€å¥— **Flutter æ¶æ„** çš„å°è¯´é˜…è¯»å™¨ã€‚
- ä»¥åŒçº§é¡¹ç›® `../legado` çš„èƒ½åŠ›ä¸ºåŠŸèƒ½åŸºçº¿ï¼Œåˆ†é˜¶æ®µå®ç°ã€‚
- UI ä½“ç³»ç»Ÿä¸€é‡‡ç”¨ `shadcn_ui`ï¼Œå®¿ä¸»ä»…ä½¿ç”¨ `CupertinoApp`ï¼ˆä¸ä½¿ç”¨ Materialï¼‰ã€‚
- å…ˆå®ç° MVPï¼ˆå¯ç”¨é˜…è¯»é“¾è·¯ï¼‰ï¼Œå†è¡¥é½é«˜çº§èƒ½åŠ›ï¼ˆè§„åˆ™å¼•æ“ã€è®¢é˜…ã€Web APIã€åŒæ­¥ç­‰ï¼‰ã€‚
- å½“å‰é˜¶æ®µèŒƒå›´è£å‰ªï¼š**ä»…åšæ–‡æœ¬å°è¯´é˜…è¯»èƒ½åŠ›**ï¼›æ¼«ç”»ã€å›¾ç‰‡ç« èŠ‚ç­‰èƒ½åŠ›æš‚ä¸çº³å…¥å®ç°èŒƒå›´ã€‚

### 1.1 å½“å‰è¿›åº¦ï¼ˆæˆªè‡³ 2026-02-11ï¼‰

- âœ… å·²å®Œæˆï¼šFlutter å·¥ç¨‹åˆå§‹åŒ–ã€`Shadcn + Cupertino` å®¿ä¸»ã€`go_router` å›› tab å£³å±‚ã€‚
- âœ… å·²å®Œæˆï¼š`Dio` ç½‘ç»œåŸºç¡€å±‚ã€`Drift` æ•°æ®å±‚ï¼ˆ`Book`/`BookSource`/`BookChapter`ï¼‰ä¸è¿ç§»åˆ° `schemaVersion=3`ã€‚
- âœ… å·²å®Œæˆï¼šlegado å…¼å®¹ä¹¦æº JSON å¯¼å…¥å™¨ï¼ˆå«æ‰¹é‡å¯¼å…¥å’Œå­—æ®µå®¹é”™ï¼‰ã€‚
- âœ… å·²å®Œæˆï¼šæœç´¢è§„åˆ™åŸºç¡€è§£æï¼ˆJSON + HTML/CSS å­é›†ï¼‰ä¸æœç´¢èšåˆæœåŠ¡ã€‚
- âœ… å·²å®Œæˆï¼šå‘ç°é¡µâ€œæœç´¢ -> åŠ å…¥ä¹¦æ¶å¹¶é˜…è¯»â€é“¾è·¯ã€‚
- âœ… å·²å®Œæˆï¼šé˜…è¯»é¡µç›®å½•/æ­£æ–‡åŠ è½½é—­ç¯ï¼ˆ`ruleToc` / `ruleContent` åŸºç¡€è·¯å¾„è§£æï¼‰ã€‚
- âœ… å·²å®Œæˆï¼šiOS GitHub Action æ‰“åŒ…æµç¨‹ï¼ˆå‚è€ƒ `soupreader`ï¼‰ã€‚
- ğŸ”„ è¿›è¡Œä¸­ï¼šå‘ legado å®Œæ•´è§„åˆ™èƒ½åŠ›å¯¹é½ï¼ˆXPath/JsonPath å…¨é‡ã€JS æ‰§è¡Œã€å¤æ‚è§„åˆ™è¯­æ³•ï¼‰ã€‚

---

## 2. å‚è€ƒè¾“å…¥

### 2.1 Legado åŠŸèƒ½æ¸…å•ï¼ˆæŒ‰æ¨¡å—æ¢³ç†ï¼‰

> ç›®æ ‡ï¼šæŠŠ Legado ä½œä¸ºâ€œåŠŸèƒ½åŸºçº¿â€ï¼Œå°½é‡ç”¨æ¨¡å—åŒ–æ¸…å•æŠŠèƒ½åŠ›ä¸€æ¬¡æ€§æ¢³ç†æ¸…æ¥šï¼Œæ–¹ä¾¿å¯¹ç…§å®ç°ä¸æ‹† TODOã€‚
>
> è¯´æ˜ï¼šä»¥ä¸‹æ¸…å•åŸºäºæœ¬åœ° `../legado` ä»“åº“çš„ READMEã€å¸®åŠ©æ–‡æ¡£ï¼ˆ`app/src/main/assets/web/help/md/*`ï¼‰ä¸ç›®å½•ç»“æ„æ•´ç†ï¼Œè¦†ç›–äº§å“ä¸»è¦èƒ½åŠ›ä¸å¯¹å¤–æ¥å£ï¼›ç»†ç¢çš„ UI å¼€å…³ä¸é€æ¡æšä¸¾ï¼Œä»¥å…å™ªéŸ³è¿‡å¤§ã€‚

#### A. å†…å®¹è·å–ä¸è§„åˆ™å¼•æ“ï¼ˆä¹¦æºæ ¸å¿ƒï¼‰

- è‡ªå®šä¹‰ä¹¦æºï¼ˆ`BookSource`ï¼‰ï¼šæœç´¢ã€å‘ç°ã€ä¹¦ç±è¯¦æƒ…ã€ç›®å½•ã€æ­£æ–‡ã€è¯„è®º/ä¹¦è¯„ç­‰è§„åˆ™å­—æ®µã€‚
- è§„åˆ™è¯­æ³•ï¼ˆå¸®åŠ©é¡µ `ruleHelp.md`ï¼‰ï¼š
  - è§„åˆ™æ ‡å¿—ï¼š`@@`ï¼ˆé»˜è®¤è§„åˆ™ï¼‰ã€`@XPath` / `@Json`ã€æ­£åˆ™ï¼ˆä»…é™ä¹¦ç±/ç›®å½•åˆ—è¡¨ç­‰ç‰¹å®šåœºæ™¯ï¼‰ã€`{{...}}` è§„åˆ™å—ç­‰ã€‚
  - URL è§„åˆ™æ”¯æŒæºå¸¦ JS å‚æ•°ï¼ˆè§£æ URL æ—¶æ‰§è¡Œï¼‰ç”¨äºåŠ¨æ€æ”¹å†™ url/headers/bodyã€‚
- JS æ‰§è¡Œï¼ˆå¸®åŠ©é¡µ `jsHelp.md`ï¼‰ï¼šRhino å¼•æ“ + `jsLib` æ³¨å…¥ï¼ˆæ”¯æŒå‡½æ•°å¤ç”¨ã€ç¼“å­˜è„šæœ¬ã€éƒ¨åˆ† Java API æš´éœ²ä¸å®‰å…¨é™åˆ¶ï¼‰ã€‚
- ç½‘ç»œä¸åçˆ¬èƒ½åŠ›ï¼š
  - è¯·æ±‚å¤´é…ç½®ã€ä»£ç†ï¼ˆHTTP / Socks4 / Socks5ï¼‰ã€CookieJarï¼ˆè‡ªåŠ¨ä¿å­˜ `Set-Cookie`ï¼‰ã€‚
  - å¹¶å‘ç‡é™åˆ¶ï¼ˆå›ºå®šé—´éš” / é¢‘æ¬¡é™åˆ¶ `20/60000`ï¼‰ã€‚
  - ç™»å½•ä½“ç³»ï¼šç™»å½• UIã€ç™»å½• URLï¼ˆå¯ JS å®ç°ï¼‰ã€ç™»å½•æ£€æŸ¥ JSï¼›å¯å€ŸåŠ© WebView å®ŒæˆéªŒè¯ç /è·³è½¬æ‹¦æˆªç­‰ã€‚
- ç‰¹æ®Šèƒ½åŠ›ï¼ˆè§„åˆ™æ‰©å±•ï¼‰ï¼š
  - å›¾ç‰‡/å°é¢è§£å¯†ï¼ˆJS è¿”å› `ByteArray`ï¼‰ã€å›¾ç‰‡è¯·æ±‚å¯è‡ªå®šä¹‰ headersã€‚
  - å­—ä½“åæ··æ·†ï¼ˆTTF å­—å½¢æ˜ å°„æ›¿æ¢ï¼‰ã€‚
  - æ–‡ä»¶å‹ä¹¦æºï¼šä¸‹è½½/è§£å‹/ç¼“å­˜ï¼Œé€‚é…â€œæ•´åŒ…ä¸‹è½½â€çš„ç«™ç‚¹ã€‚

#### B. ä¹¦æºç®¡ç†ä¸è°ƒè¯•

- ç®¡ç†ï¼šæ–°å»º/ç¼–è¾‘ã€åˆ†ç»„ç­›é€‰ã€å¯ç”¨/ç¦ç”¨ã€å¯ç”¨/ç¦ç”¨å‘ç°ã€ç½®é¡¶/ç½®åº•ã€å¯¼å…¥/å¯¼å‡º/åˆ†äº«ã€‚
- å¯¼å…¥ï¼šæœ¬åœ°å¯¼å…¥ã€ç½‘ç»œå¯¼å…¥ã€äºŒç»´ç å¯¼å…¥ï¼ˆå¸®åŠ©é¡µ `SourceMBookHelp.md`ï¼‰ã€‚
- æ ¡éªŒï¼šæ‰¹é‡æ ¡éªŒæœç´¢/å‘ç°/ç›®å½•/æ­£æ–‡ï¼Œè‡ªåŠ¨ç­›é€‰å¤±æ•ˆæºï¼ˆç»“æœå—ç½‘ç»œç­‰å› ç´ å½±å“ï¼‰ã€‚
- è°ƒè¯•ï¼šè°ƒè¯•æœç´¢/å‘ç°/è¯¦æƒ…/ç›®å½•/æ­£æ–‡ï¼ˆå¸®åŠ©é¡µ `debugHelp.md`ï¼Œå« `++/--` ç­‰å‰ç¼€çº¦å®šï¼‰ã€‚

#### C. æ‰¾ä¹¦é“¾è·¯ï¼ˆå‘ç° / æœç´¢ / è¯¦æƒ… / æ¢æºï¼‰

- æœç´¢ï¼šå¤šä¹¦æºèšåˆæœç´¢ã€åˆ†é¡µã€æ¥æºç­›é€‰ï¼ˆèƒ½åŠ›å–å†³äºä¹¦æºè§„åˆ™ä¸å¹¶å‘ç­–ç•¥ï¼‰ã€‚
- å‘ç°ï¼šåŸºäºâ€œå‘ç°è§„åˆ™â€çš„æ¦œå•/åˆ†ç±»å…¥å£ï¼ˆå¹¶éæ‰€æœ‰ä¹¦æºéƒ½æœ‰å‘ç°ï¼‰ã€‚
- è¯¦æƒ…ï¼šä¹¦ç±ç®€ä»‹ã€ç›®å½•é¢„è§ˆã€åŠ å…¥ä¹¦æ¶ï¼›æ”¯æŒæ¢æºã€ç¼–è¾‘ä¹¦ç±å…ƒä¿¡æ¯ç­‰ã€‚

#### D. ä¹¦æ¶ä¸ä¹¦ç±ç®¡ç†

- ä¹¦æ¶ï¼šåˆ—è¡¨/ç½‘æ ¼åˆ‡æ¢ï¼›ä¸‹æ‹‰åˆ·æ–°ï¼›æ›´æ–°æç¤º/æœªè¯»ç« èŠ‚æ•°ï¼›åˆ†ç»„/æ’åºã€‚
- ä¹¦ç±è¯¦æƒ…ï¼šåˆ é™¤ã€æ¢æºã€å…è®¸/ç¦æ­¢æ›´æ–°ã€ç¼–è¾‘ä¹¦å/ä½œè€…/ç®€ä»‹ã€æ¢å°é¢ç­‰ã€‚
- ç¼“å­˜/å¯¼å‡ºï¼šç¦»çº¿ç¼“å­˜ã€ç¼“å­˜ç®¡ç†ã€å¯¼å‡º TXT/EPUBï¼ˆæ”¯æŒè‡ªå®šä¹‰å¯¼å‡ºæ–‡ä»¶åï¼‰ã€å¯¼å‡ºåˆ° WebDav ç­‰ã€‚

#### E. é˜…è¯»å™¨ï¼ˆé˜…è¯»ä½“éªŒæ ¸å¿ƒï¼‰

- æ’ç‰ˆé«˜åº¦è‡ªå®šä¹‰ï¼šå­—ä½“ã€å­—å·ã€é¢œè‰²ã€èƒŒæ™¯ã€è¡Œè·/æ®µè·ã€åŠ ç²—ã€ç®€ç¹è½¬æ¢ã€å¯¹é½ï¼ˆå«â€œæ–‡å­—åº•éƒ¨å¯¹é½â€ï¼‰ç­‰ã€‚
- å¤šç¿»é¡µæ¨¡å¼ï¼šè¦†ç›–/ä»¿çœŸ/æ»‘åŠ¨/æ»šåŠ¨ç­‰ï¼›æ”¯æŒè‡ªåŠ¨ç¿»é¡µã€‚
- ä¸»é¢˜ä¸äº®åº¦ï¼šç™½å¤©/å¤œé—´ä¸»é¢˜ã€èƒŒæ™¯ä¸å…±ç”¨å¸ƒå±€ï¼›äº®åº¦æ§ä»¶ï¼ˆå¯è·Ÿéšç³»ç»Ÿï¼‰ã€‚
- äº¤äº’ä¸å¿«æ·ï¼šç‚¹å‡»åŒºåŸŸè®¾ç½®ã€è‡ªå®šä¹‰ç¿»é¡µæŒ‰é”®ã€éŸ³é‡é”®ç¿»é¡µã€å±å¹•æ–¹å‘/è¶…æ—¶ã€éšè—çŠ¶æ€æ /å¯¼èˆªæ ç­‰ï¼ˆå¸®åŠ©é¡µ `readMenuHelp.md`ï¼‰ã€‚
- å·¥å…·èƒ½åŠ›ï¼šå…¨æ–‡æœç´¢ï¼ˆæœ¬åœ°ç¼“å­˜/æœ¬åœ°æ–‡ä»¶ï¼‰ã€ç›®å½•/ä¹¦ç­¾é¢æ¿ã€é˜…è¯»è¿›åº¦ä¿å­˜ä¸æ¢å¤ã€‚
- å›¾ç‰‡ç« èŠ‚/æ¼«ç”»ï¼šå›¾ç‰‡æ ·å¼ï¼ˆå¦‚ `full`ï¼‰ã€ç¼©æ”¾ã€æ»šåŠ¨æ¨¡å¼é€‚é…ç­‰ï¼ˆå¸®åŠ©é¡µ `appHelp.md`ï¼Œå½“å‰é˜¶æ®µä¸åšï¼‰ã€‚

#### F. æ›¿æ¢å‡€åŒ–ï¼ˆReplaceRuleï¼‰

- æ­£æ–‡æ›¿æ¢/å»å¹¿å‘Š/çº é”™ï¼šæ”¯æŒæ­£åˆ™ã€åˆ†ç»„ã€æ’åºã€å¯ç”¨/ç¦ç”¨ï¼›å¯é™å®šä½œç”¨èŒƒå›´ï¼ˆä¹¦å/æºåï¼‰ã€‚
- è§„åˆ™ç®¡ç†ï¼šå¯¼å…¥/æ–°å»º/æ’åº/é€‰æ‹©æ“ä½œï¼ˆå¸®åŠ©é¡µ `replaceRuleHelp.md`ï¼‰ã€‚

#### G. å¬ä¹¦ï¼ˆTTS / åœ¨çº¿æœ—è¯»å¼•æ“ï¼‰

- ç³»ç»Ÿ TTSï¼šåˆ‡æ¢æœ¬åœ°æœ—è¯»å¼•æ“ï¼›æ”¯æŒåå°æœ—è¯»ä¸æœ—è¯»è®¾ç½®ï¼ˆå¸®åŠ©é¡µ `readMenuHelp.md`ï¼‰ã€‚
- åœ¨çº¿æœ—è¯»ï¼ˆHttpTTSï¼‰ï¼šURL è§„åˆ™ + JS å‚æ•°ï¼ˆ`speakText`ã€`speakSpeed`ï¼‰ï¼ˆå¸®åŠ©é¡µ `httpTTSHelp.md`ï¼‰ã€‚

#### H. æœ¬åœ°ä¸è¿œç¨‹ä¹¦ç±ï¼ˆTXT / EPUB / WebDav ä¹¦ç±ï¼‰

- æœ¬åœ°ä¹¦ç±ï¼šTXT/EPUB å¯¼å…¥ï¼ˆæ‰‹åŠ¨æµè§ˆã€æ™ºèƒ½æ‰«æã€æ–‡ä»¶ç®¡ç†å™¨æ‰“å¼€ï¼‰ã€‚
- TXT ç›®å½•è§„åˆ™ï¼ˆTxtTocRuleï¼‰ï¼šè‡ªå®šä¹‰è§„åˆ™ã€å¯¼å…¥é»˜è®¤è§„åˆ™ã€ç½‘ç»œå¯¼å…¥ï¼›è‡ªåŠ¨è¯†åˆ«å¼€å…³ï¼›è¶…é•¿ç« èŠ‚è‡ªåŠ¨æ‹†åˆ†ï¼ˆå¸®åŠ©é¡µ `txtTocRuleHelp.md`ï¼‰ã€‚
- WebDav ä¹¦ç±ï¼šä¸Šä¼ /ä¸‹è½½ã€è·¨è®¾å¤‡åŒæ­¥ä¹¦ç±æ–‡ä»¶ä¸è¿›åº¦ï¼ˆå¸®åŠ©é¡µ `webDavBookHelp.md`ï¼‰ã€‚

#### I. è®¢é˜… / RSS

- è®¢é˜…æºï¼ˆRssSourceï¼‰ï¼šè§„åˆ™è®¢é˜…ä»»æ„ç½‘ç»œå†…å®¹ï¼›æœ¬åœ°/ç½‘ç»œ/äºŒç»´ç å¯¼å…¥ä¸åˆ†äº«ï¼ˆå¸®åŠ©é¡µ `SourceMRssHelp.md`ï¼‰ã€‚
- é˜…è¯»ä¸ç®¡ç†ï¼šè®¢é˜…/æ–‡ç« åˆ—è¡¨ã€æ”¶è—ã€é˜…è¯»è®°å½•ï¼›è®¢é˜…é˜…è¯»é¡µæ”¯æŒ JS æ‹¦æˆªè·³è½¬å¹¶è”åŠ¨â€œæœç´¢/åŠ å…¥ä¹¦æ¶â€ç­‰èƒ½åŠ›ï¼ˆå¸®åŠ©é¡µ `jsHelp.md`ï¼‰ã€‚

#### J. å¤‡ä»½ä¸åŒæ­¥

- æœ¬åœ°å¤‡ä»½ä¸æ¢å¤ã€‚
- WebDav äº‘å¤‡ä»½ï¼šè‡ªåŠ¨å¤‡ä»½ï¼ˆé€€å‡ºè§¦å‘/åŒæ—¥è¦†ç›–/è·¨æ—¥ä¿ç•™ï¼‰ã€æ¢å¤é€‰æ‹©å†å²å¤‡ä»½ï¼ˆå¸®åŠ©é¡µ `webDavHelp.md` ä¸ `appHelp.md`ï¼‰ã€‚

#### K. å¯¹å¤–æ¥å£ä¸ Web ç«¯

- URL Schemeï¼š`legado://import/{path}?src={url}`ï¼Œæ”¯æŒå¯¼å…¥ `bookSource` / `rssSource` / `replaceRule` / `textTocRule` / `httpTTS` / `theme` / `readConfig` / `dictRule` / `addToBookshelf` ç­‰ï¼ˆè§ `../legado/README.md`ï¼‰ã€‚
- Web æœåŠ¡ï¼ˆHTTP + WebSocketï¼‰ä¸ Content Providerï¼šä¹¦æº/è®¢é˜…æº/æ›¿æ¢è§„åˆ™/ä¹¦æ¶/ç« èŠ‚/æ­£æ–‡/å°é¢/å›¾ç‰‡/è¿›åº¦ç­‰ï¼ˆè§ `../legado/api.md`ï¼‰ã€‚
- Web ç«¯ï¼ˆVue3ï¼‰ï¼šWeb ä¹¦æ¶ã€Web ä¹¦æºç¼–è¾‘ã€Web è®¢é˜…æºç¼–è¾‘ï¼ˆè§ `../legado/modules/web/README.md`ï¼‰ã€‚

### 2.2 shadcn_ui æ–‡æ¡£è¦ç‚¹ï¼ˆllms.txtï¼‰

æ¥æºï¼š`https://mariuti.com/flutter-shadcn-ui/llms.txt`

- å®‰è£…ï¼š`flutter pub add shadcn_ui`
- æ¨èé›†æˆï¼š`ShadApp.custom` + `CupertinoApp`/`CupertinoApp.router` + `ShadAppBuilder`
- å›½é™…åŒ–å§”æ‰˜ï¼šè¡¥é½ `DefaultMaterialLocalizations`ã€`DefaultCupertinoLocalizations`ã€`DefaultWidgetsLocalizations`
- ä¸»é¢˜ç­–ç•¥ï¼š`ShadThemeData` + äº®/æš—ä¸»é¢˜ + `ShadColorScheme`
- ç»„ä»¶è¦†ç›–ï¼šè¡¨å•ã€å¼¹å±‚ã€å¯¼èˆªã€è¡¨æ ¼ã€Tabsã€Toastã€Sheetã€Dialogã€Selectã€Inputã€Slider ç­‰ï¼Œè¶³ä»¥è¦†ç›–é˜…è¯»å™¨é…ç½®å’Œä¹¦æºç®¡ç†åœºæ™¯ã€‚

### 2.3 å¼€å‘è§„èŒƒï¼ˆLegado å¯¹ç…§ä¼˜å…ˆï¼‰

> æœ¬è§„èŒƒä¸ºå½“å‰é˜¶æ®µå¼ºåˆ¶æµç¨‹ï¼š**å…ˆå¯¹ç…§ legado æºç ï¼Œå†åœ¨æœ¬é¡¹ç›®å®ç°**ã€‚

1. åŠŸèƒ½å¼€å§‹å‰ï¼šå…ˆåœ¨ `../legado` å®šä½å¯¹åº”å®ç°ï¼ˆè‡³å°‘è¦†ç›– UI å…¥å£ + æ ¸å¿ƒé€»è¾‘ï¼‰ã€‚
2. æ–¹æ¡ˆè®¾è®¡æ—¶ï¼šå…ˆè®°å½• legado çš„è¡Œä¸ºè¾¹ç•Œï¼ˆè¾“å…¥ã€çŠ¶æ€ã€å¼‚å¸¸ã€æŒä¹…åŒ–ï¼‰ã€‚
3. ç¼–ç å®ç°æ—¶ï¼šæŒ‰â€œè¡Œä¸ºä¸€è‡´ä¼˜å…ˆã€å®ç°å¯ç®€åŒ–â€åŸåˆ™è½åœ°ï¼›è‹¥æœ‰ç®€åŒ–éœ€æ˜ç¡®æ ‡æ³¨ã€‚
4. å®Œæˆåè‡ªæ£€ï¼šè¡¥ä¸€æ¡â€œæºç å¯¹ç…§è®°å½•â€ï¼ˆå¯¹åº”æ–‡ä»¶ã€å½“å‰å·®å¼‚ã€æ˜¯å¦æ¥å—ï¼‰ã€‚
5. æäº¤å‰å›å½’ï¼šå¯¹æœ¬æ¬¡æ¶‰åŠæ¨¡å—é€é¡¹å¤æ ¸ï¼Œé¿å…å‡ºç°â€œæœªå¯¹ç…§å…ˆå®ç°â€ã€‚

å¯¹ç…§è®°å½•æ¨¡æ¿ï¼ˆæ¯ä¸ªåŠŸèƒ½è‡³å°‘ä¸€æ¡ï¼‰ï¼š

- åŠŸèƒ½åç§°ï¼š
- legado æºç ä½ç½®ï¼š
- æœ¬é¡¹ç›®å®ç°ä½ç½®ï¼š
- ä¸€è‡´ç‚¹ï¼š
- å·®å¼‚ç‚¹ï¼ˆè‹¥æœ‰ï¼‰ï¼š
- å¤„ç†ç»“è®ºï¼ˆä¿®å¤ / æ¥å—å¹¶è®°å½•åŸå› ï¼‰ï¼š

---

## 3. æ€»ä½“æ¶æ„è®¾è®¡

## 3.1 æ¶æ„åŸåˆ™

- **Feature First**ï¼šæŒ‰ä¸šåŠ¡åŸŸæ‹†åˆ†æ¨¡å—ï¼Œè€Œéçº¯æŒ‰æŠ€æœ¯å±‚æ‹†åˆ†ã€‚
- **Clean + Vertical Slice**ï¼šæ¯ä¸ª feature å†…å« `presentation/domain/data`ï¼Œé™ä½è·¨ç›®å½•è·³è½¬æˆæœ¬ã€‚
- **å¯æ›¿æ¢åŸºç¡€è®¾æ–½**ï¼šæ•°æ®åº“ã€JS å¼•æ“ã€ç½‘ç»œå±‚éƒ½é€šè¿‡æŠ½è±¡æ¥å£éš”ç¦»ã€‚
- **å…¼å®¹ä¼˜å…ˆ**ï¼šä¼˜å…ˆå…¼å®¹ legado ä¹¦æº JSON ç»“æ„ä¸æ ¸å¿ƒè§„åˆ™å­—æ®µã€‚

### 3.2 å»ºè®®ç›®å½•ï¼ˆç›®æ ‡æ€ï¼‰

```text
lib/
  app/
    app.dart
    router.dart
    theme/
  bootstrap/
    bootstrap.dart
  core/
    constants/
    errors/
    utils/
    network/
    storage/
    parser/
    js_engine/
  shared/
    widgets/
    extensions/
  features/
    bookshelf/
      presentation/
      domain/
      data/
    source_management/
      presentation/
      domain/
      data/
    discovery_search/
      presentation/
      domain/
      data/
    reader/
      presentation/
      domain/
      data/
    rss/
    settings/
    import_export/
    sync_api/
```

### 3.3 æŠ€æœ¯é€‰å‹ï¼ˆé¦–é€‰ï¼‰

- UIï¼š`shadcn_ui`ï¼ˆä¸»ï¼‰+ `Cupertino`ï¼ˆå®¿ä¸»ï¼‰
- çŠ¶æ€ç®¡ç†ï¼š`riverpod`ï¼ˆå»ºè®® `flutter_riverpod` + `riverpod_generator`ï¼‰
- è·¯ç”±ï¼š`go_router`
- ç½‘ç»œï¼š`dio`
- æœ¬åœ°æ•°æ®åº“ï¼š`drift`ï¼ˆSQLiteï¼Œæ”¯æŒè¿ç§»ä¸å¤æ‚æŸ¥è¯¢ï¼‰
- JSON åºåˆ—åŒ–ï¼š`freezed` + `json_serializable`
- æœ¬åœ°ç¼“å­˜ï¼š`shared_preferences` / `hive`ï¼ˆè½»é‡é…ç½®ï¼‰
- æ–‡æœ¬/è§„åˆ™è§£æï¼š`html`ã€XPath/JsonPath å¯¹åº” Dart åº“ï¼ˆéœ€ PoC éªŒè¯ï¼‰
- JS æ‰§è¡Œï¼šQuickJS/flutter_js å€™é€‰ï¼ˆéœ€ PoC éªŒè¯ä¸æ€§èƒ½å‹æµ‹ï¼‰

> è¯´æ˜ï¼šè§„åˆ™å¼•æ“ï¼ˆXPath/JsonPath/JSï¼‰æ˜¯æŠ€æœ¯é£é™©æœ€é«˜æ¨¡å—ï¼Œå¿…é¡»åœ¨ P1 é˜¶æ®µå®Œæˆå¯è¡Œæ€§éªŒè¯å†å¤§è§„æ¨¡æ¨è¿›ã€‚

---

## 4. legado åˆ° Flutter çš„æ¨¡å—æ˜ å°„

| legado æ¨¡å— | Flutter å¯¹åº”æ¨¡å— | è¯´æ˜ |
|---|---|---|
| `data/entities/*` | `features/*/domain/models` + `data/dtos` | ä¿æŒé¢†åŸŸæ¨¡å‹ç¨³å®šï¼ŒDTO åšå…¼å®¹è½¬æ¢ |
| `data/dao/*` + Room | `features/*/data/local` + Drift | æŒ‰ feature æ‹†è¡¨ä¸ DAO |
| `model/webBook/*` | `features/discovery_search/domain/services` | æœç´¢ã€ä¹¦ç±è¯¦æƒ…ã€ç›®å½•ã€æ­£æ–‡æŠ“å– |
| `help/source/*` | `core/parser` + `core/js_engine` | è§„åˆ™è§£æå’Œæ‰§è¡Œå†…æ ¸ |
| `ui/main/bookshelf` | `features/bookshelf/presentation` | ä¹¦æ¶ã€åˆ†ç»„ã€æ’åºã€æœ€è¿‘é˜…è¯» |
| `ui/book/read/*` | `features/reader/presentation` | é˜…è¯»é¡µã€ç¿»é¡µã€æ ·å¼ã€èœå•ã€TTS |
| `ui/book/source` | `features/source_management/presentation` | ä¹¦æºå¢åˆ æ”¹æŸ¥ã€åˆ†ç»„ã€å¯¼å…¥ |
| `api/controller/*` + `web/*` | `features/sync_api` | æœ¬åœ° API / WebSocketï¼ˆåç½®é˜¶æ®µï¼‰ |

---

## 5. åˆ†é˜¶æ®µå®æ–½è®¡åˆ’ï¼ˆPlan Modeï¼‰

## P0ï¼šå·¥ç¨‹åˆå§‹åŒ–ï¼ˆ1-2 å¤©ï¼Œå·²å®Œæˆï¼‰

ç›®æ ‡ï¼šå¾—åˆ°å¯è¿è¡Œçš„ Flutter é¡¹ç›®éª¨æ¶ + Shadcn ä¸»é¢˜åŸºåº§

- åˆå§‹åŒ–å·¥ç¨‹ã€ç›®å½•ã€ç¯å¢ƒé…ç½®ï¼ˆdev/prodï¼‰
- æ¥å…¥ `shadcn_ui`ï¼Œä½¿ç”¨ `ShadApp.custom + CupertinoApp.router`
- å»ºç«‹ä¸»é¢˜ç³»ç»Ÿï¼ˆäº®/æš—ã€å­—ä½“ã€åŸºç¡€ tokenï¼‰
- å»ºç«‹è·¯ç”±ä¸å£³å±‚é¡µé¢ï¼ˆä¹¦æ¶/å‘ç°/é˜…è¯»/è®¾ç½®ç©ºé¡µé¢ï¼‰

äº¤ä»˜æ ‡å‡†ï¼š

- `flutter run` å¯å¯åŠ¨
- ä¸»é¢˜åˆ‡æ¢å¯ç”¨
- è·¯ç”±è·³è½¬å¯ç”¨

## P1ï¼šåŸºç¡€èƒ½åŠ›å±‚ï¼ˆ3-5 å¤©ï¼Œå·²å®Œæˆï¼‰

ç›®æ ‡ï¼šæ„å»ºé•¿æœŸå¯ç»´æŠ¤åº•åº§

- ç½‘ç»œå±‚ï¼ˆDio + æ‹¦æˆªå™¨ + é”™è¯¯æ¨¡å‹ï¼‰
- æœ¬åœ°å­˜å‚¨ï¼ˆDrift è¡¨ç»“æ„ v1ï¼šBookã€BookSourceã€BookChapterã€ReadRecordã€Bookmarkï¼‰
- é…ç½®ä¸­å¿ƒï¼ˆé˜…è¯»è®¾ç½®ã€ä¸»é¢˜è®¾ç½®ã€å®éªŒå¼€å…³ï¼‰
- è§„åˆ™å¼•æ“ PoCï¼ˆHTML/XPath/JsonPath/JS æœ€å°é—­ç¯ï¼‰

äº¤ä»˜æ ‡å‡†ï¼š

- èƒ½ä»æœ¬åœ°æ ·ä¾‹è§„åˆ™è§£æå‡ºä¹¦åã€ç›®å½•ã€æ­£æ–‡
- è¡¨ç»“æ„å¯è¿ç§»ï¼ˆè‡³å°‘ 1 æ¬¡ migration æ¼”ç»ƒï¼‰

## P2ï¼šä¹¦æºä¸æœç´¢ï¼ˆ4-7 å¤©ï¼ŒåŸºç¡€é—­ç¯å·²å®Œæˆï¼‰

ç›®æ ‡ï¼šæ‰“é€šâ€œæ‰¾ä¹¦â€é“¾è·¯

- ä¹¦æºç®¡ç†ï¼šå¯¼å…¥ã€å¯åœã€åˆ†ç»„ã€ç¼–è¾‘
- æœç´¢é¡µï¼šå…³é”®è¯æœç´¢ã€æ¥æºç­›é€‰ã€ç»“æœèšåˆ
- ä¹¦ç±è¯¦æƒ…ï¼šç®€ä»‹ã€ç›®å½•é¢„è§ˆã€åŠ å…¥ä¹¦æ¶
- é”™è¯¯å¯è§‚æµ‹ï¼šè¶…æ—¶ã€è§„åˆ™å¼‚å¸¸ã€è§£æå¤±è´¥æç¤º

äº¤ä»˜æ ‡å‡†ï¼š

- è‡³å°‘ 1-2 ä¸ªçœŸå®ä¹¦æºå¯ç¨³å®šæœç´¢/æ‹‰å–ç›®å½•
- åŠ å…¥ä¹¦æ¶åå¯ç¦»çº¿ä¿ç•™å…ƒæ•°æ®

## P3ï¼šé˜…è¯»æ ¸å¿ƒï¼ˆ5-8 å¤©ï¼ŒåŸºç¡€é—­ç¯å·²å®Œæˆï¼‰

ç›®æ ‡ï¼šæ‰“é€šâ€œçœ‹ä¹¦â€é“¾è·¯

- é˜…è¯»é¡µï¼šç« èŠ‚åŠ è½½ã€è¿›åº¦ä¿å­˜ã€ä¸Šä¸‹ç« è·³è½¬
- é˜…è¯»é…ç½®ï¼šå­—ä½“/è¡Œè·/è¾¹è·/ä¸»é¢˜/ç¿»é¡µæ¨¡å¼
- æ–‡æœ¬å‡€åŒ–ï¼šæ›¿æ¢è§„åˆ™å¯åœã€é¢„è§ˆ
- ä¹¦ç­¾ä¸é˜…è¯»å†å²

äº¤ä»˜æ ‡å‡†ï¼š

- ä¹¦æ¶ -> é˜…è¯» -> é€€å‡º -> æ¢å¤è¿›åº¦å®Œæ•´é—­ç¯
- é˜…è¯»é…ç½®å®æ—¶ç”Ÿæ•ˆ

## P4ï¼šå¢å¼ºèƒ½åŠ›ï¼ˆå¹¶è¡Œ/åç»­ï¼‰

- æœ¬åœ° TXT/EPUB å¯¼å…¥
- RSS è®¢é˜…ä¸é˜…è¯»
- TTS æœ—è¯»ï¼ˆå¹³å°èƒ½åŠ› + å¯æ‰©å±•å¼•æ“ï¼‰
- WebDAV/äº‘åŒæ­¥
- æœ¬åœ° Web API / WebSocketï¼ˆå…¼å®¹ legado å¸¸ç”¨æ¥å£ï¼‰

---

## 6. Shadcn ç»„ä»¶è½ä½å»ºè®®

- ä¹¦æ¶ï¼š`ShadTabs` + `ShadCard` + `ShadContextMenu`
- æœç´¢ï¼š`ShadInput` + `ShadSelect` + `ShadButton` + `ShadTable`
- é˜…è¯»è®¾ç½®ï¼š`ShadSheet` + `ShadSlider` + `ShadSwitch` + `ShadRadioGroup`
- å¼¹çª—äº¤äº’ï¼š`ShadDialog` / `ShadPopover` / `ShadToast`
- è¡¨å•åœºæ™¯ï¼ˆä¹¦æºç¼–è¾‘ï¼‰ï¼š`ShadForm` + æ ¡éªŒè§„åˆ™

---

## 7. é£é™©ä¸å¯¹ç­–

- è§„åˆ™å¼•æ“å…¼å®¹é£é™©é«˜ï¼šå…ˆåšæœ€å°è§„åˆ™å­é›†ï¼ˆæœç´¢/ç›®å½•/æ­£æ–‡ï¼‰ï¼Œé€æ­¥æ‰©å±•ã€‚
- Flutter ç«¯ JS æ€§èƒ½ä¸å®‰å…¨ï¼šé™åˆ¶è„šæœ¬æ‰§è¡Œè¶…æ—¶ã€å†…å­˜ã€å¹¶å‘ï¼›åŠ å…¥ç†”æ–­ä¸é™çº§ã€‚
- å¤šæºèšåˆç¨³å®šæ€§ï¼šè¯·æ±‚å¹¶å‘ä¸Šé™ã€é‡è¯•ã€æ–­è·¯å™¨ã€æºå¥åº·è¯„åˆ†ã€‚
- é˜…è¯»ä½“éªŒç»†èŠ‚å¤æ‚ï¼šå…ˆä¿æ ¸å¿ƒï¼ˆåˆ†é¡µ/è¿›åº¦/æ ·å¼ï¼‰ï¼Œé«˜çº§åŠ¨æ•ˆåç½®ã€‚

---

## 8. è¿‘æœŸæ‰§è¡Œæ¸…å•ï¼ˆä¸»æµç¨‹ä¼˜å…ˆï¼‰

### 8.1 ä¸»æµç¨‹ï¼ˆå…ˆå®Œæˆï¼‰

1. æ‰“é€šæ‰¾ä¹¦ä¸»é“¾è·¯ï¼šå‘ç°æœç´¢ -> ä¹¦ç±è¯¦æƒ…ï¼ˆ`ruleBookInfo`ï¼‰-> åŠ å…¥ä¹¦æ¶ -> æ‰“å¼€é˜…è¯»ã€‚
2. ç¨³å®šé˜…è¯»ä¸»é“¾è·¯ï¼šä¹¦æ¶æ‰“å¼€ -> ç›®å½•/æ­£æ–‡åŠ è½½ -> è¿›åº¦å†™å›ä¸æ¢å¤ã€‚
3. å·©å›ºé˜…è¯»é—­ç¯ï¼šé˜…è¯»å™¨æ ¸å¿ƒè®¾ç½® + å…¨æ–‡æœç´¢ + ä¹¦ç­¾/å†å²ã€‚

### 8.2 ä¸»æµç¨‹å®Œæˆåï¼ˆå†åšç»†èŠ‚ä¼˜åŒ–ï¼‰

1. è§„åˆ™å¼•æ“æ·±åº¦å¯¹é½ï¼šXPath/JsonPath/JS å…¨é‡ä¸è°ƒè¯•èƒ½åŠ›ã€‚
2. é˜…è¯»ä½“éªŒç»†èŠ‚ï¼šè¦†ç›–åˆ†é¡µç²¾åº¦ã€åŠ¨ç”»ç»†èŠ‚ã€èœå•äº¤äº’ä¸€è‡´æ€§ã€‚
3. èƒ½åŠ›æ‰©å±•ï¼šæœ¬åœ°ä¹¦å¯¼å…¥ã€ç¦»çº¿ç¼“å­˜ã€å¯¼å‡ºã€åŒæ­¥ä¸æ¥å£ç”Ÿæ€ã€‚

---

## 9. éªŒæ”¶åŸºçº¿ï¼ˆMVPï¼‰

- å¯å¯¼å…¥ä¹¦æºå¹¶æœç´¢åˆ°ä¹¦ã€‚
- å¯åŠ å…¥ä¹¦æ¶å¹¶æ‰“å¼€é˜…è¯»ã€‚
- å¯ä¿å­˜/æ¢å¤é˜…è¯»è¿›åº¦ã€‚
- å¯ä¿®æ”¹é˜…è¯»ä¸»é¢˜å’Œæ–‡æœ¬æ ·å¼ã€‚
- æ ¸å¿ƒé¡µé¢å…¨éƒ¨é‡‡ç”¨ shadcn é£æ ¼ç»„ä»¶ã€‚

---

## 10. å¯¹æ ‡ Legado TODO Backlogï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

> ä½¿ç”¨æ–¹å¼ï¼šæŠŠæœ¬èŠ‚å½“ä½œâ€œäº§å“å¾…åŠæ± â€ï¼Œä»¥ Legado åŠŸèƒ½æ¸…å•ä¸ºå‚ç…§ï¼›å®ç°è¿‡ç¨‹ä¸­å†æ‹†æˆæ›´ç»†çš„ Issue/ä»»åŠ¡å¡ã€‚
>
> çŠ¶æ€çº¦å®šï¼š`[x]` å·²å®Œæˆï¼Œ`[ ]` æœªå®Œæˆï¼ˆå¯åœ¨æ¡ç›®åè¿½åŠ â€œè¿›è¡Œä¸­/é˜»å¡/ä¾èµ–â€ï¼‰ã€‚

### P0ï¼šè¯»å†™é—­ç¯ï¼ˆå½“å‰å·²å…·å¤‡é›å½¢ï¼‰

- [x] å·¥ç¨‹éª¨æ¶ï¼š`Shadcn + Cupertino` å®¿ä¸»ã€`go_router` å›› tab å£³å±‚ã€‚
- [x] ç½‘ç»œå±‚ï¼š`dio` + åŸºç¡€ç½‘å…³ï¼ˆå« `mock://` æ¼”ç¤ºæ¥å£ï¼‰ã€‚
- [x] æ•°æ®å±‚ï¼š`drift`ï¼ˆ`Book` / `BookSource` / `BookChapter`ï¼‰+ è¿ç§»åˆ° `schemaVersion=3`ã€‚
- [x] ä¹¦æºå¯¼å…¥ï¼šå…¼å®¹ Legado ä¹¦æº JSONï¼ˆæ‰¹é‡å¯¼å…¥ + å­—æ®µå®¹é”™ï¼‰ã€‚
- [x] æ‰¾ä¹¦ï¼šæœç´¢è§„åˆ™åŸºç¡€è§£æï¼ˆJSON + HTML/CSS å­é›†ï¼‰+ èšåˆæœç´¢æœåŠ¡ã€‚
- [x] é˜…è¯»æœ€å°é“¾è·¯ï¼šå‘ç°é¡µæœç´¢ -> åŠ å…¥ä¹¦æ¶ -> ç›®å½•/æ­£æ–‡æŠ“å– -> é˜…è¯»é¡µå±•ç¤ºï¼ˆ`ruleToc` / `ruleContent` çš„åŸºç¡€è·¯å¾„è§£æï¼‰ã€‚
- [x] ä¹¦æ¶é¡µæ¥å…¥çœŸå®æ•°æ®ï¼ˆå½“å‰ä¸ºå ä½å¡ç‰‡ï¼‰ï¼Œè‡³å°‘æ”¯æŒâ€œæœ€è¿‘é˜…è¯»æ’åº/æ‰“å¼€é˜…è¯»â€ã€‚
- [x] é˜…è¯»è¿›åº¦å†™å›ï¼ˆ`durChapterIndex/durChapterPos/durChapterTime`ï¼‰å¹¶åœ¨è¿›å…¥é˜…è¯»æ—¶æ¢å¤ã€‚

### P1ï¼šè§„åˆ™å¼•æ“å¯¹é½ï¼ˆå½“å‰ä¸»æ”»ï¼‰

- [ ] ç»Ÿä¸€è§„åˆ™æ¨¡å‹ä¸æ‰§è¡Œå™¨ï¼šåŒä¸€å¥—è§£æ/æ‰§è¡Œè¦†ç›– `ruleSearch/ruleBookInfo/ruleToc/ruleContent/ruleExplore`ã€‚
- [ ] XPath å…¨é‡æ”¯æŒï¼ˆå«å¸¸ç”¨å‡½æ•°/è½´/è°“è¯­ï¼›ä¸ Legado è§„åˆ™æ ‡å¿—å…¼å®¹ï¼‰ã€‚
- [ ] JsonPath å…¨é‡æ”¯æŒï¼ˆè€Œä¸æ˜¯å½“å‰çš„ç‚¹è·¯å¾„å­é›†ï¼‰ã€‚
- [ ] JS æ‰§è¡Œèƒ½åŠ›ï¼ˆæ›¿ä»£ Rhinoï¼‰ï¼šæä¾›è¶…æ—¶/å†…å­˜/å¹¶å‘é™åˆ¶ä¸æœ€å° `java.*` bridgeï¼ˆä»¥æ»¡è¶³å¸¸è§ä¹¦æºï¼‰ã€‚
- [ ] URL è§„åˆ™èƒ½åŠ›ï¼šmethod/headers/bodyã€é‡å®šå‘å¤„ç†ã€åŠ¨æ€å‚æ•°ã€å›¾ç‰‡è¯·æ±‚ headersã€‚
- [ ] CookieJarï¼šæŒ‰ä¹¦æºæŒä¹…åŒ– cookieï¼Œæ”¯æŒç™»å½•æ€ä¸éªŒè¯ç åœºæ™¯ã€‚
- [ ] å¹¶å‘ä¸é™æµï¼šæ”¯æŒæ¯æº `concurrentRate` + å…¨å±€å¹¶å‘ä¸Šé™ï¼›å¤±è´¥é‡è¯•ä¸ç†”æ–­/é™çº§ç­–ç•¥ã€‚
- [ ] è°ƒè¯•èƒ½åŠ›ï¼šä¹¦æºè°ƒè¯•å…¥å£ï¼ˆæœç´¢/å‘ç°/è¯¦æƒ…/ç›®å½•/æ­£æ–‡ï¼‰+ å¯è¯»é”™è¯¯æç¤ºï¼ˆè§„åˆ™/JS/ç½‘ç»œ/è§£æï¼‰ã€‚

### P2ï¼šä¹¦æ¶ä¸é˜…è¯»å™¨ä½“éªŒï¼ˆäº§å“å±‚é¢â€œå¯ç”¨â€ï¼‰

- [ ] ä¹¦æºç®¡ç† UIï¼šåˆ—è¡¨/ç­›é€‰/åˆ†ç»„/å¯ç”¨ç¦ç”¨/å¯¼å…¥å¯¼å‡º/åˆ†äº«ï¼ˆå…ˆåšâ€œç®¡ç†â€ï¼Œé«˜çº§æ ¡éªŒ/è°ƒè¯•å¯åç½®ï¼‰ã€‚
- [x] ä¹¦ç±è¯¦æƒ…æµï¼ˆ`ruleBookInfo`ï¼‰ï¼šç®€ä»‹/å°é¢/ä½œè€…/ç›®å½•é¢„è§ˆï¼›åŠ å…¥/ç§»é™¤ä¹¦æ¶ï¼›æ¢æºå…¥å£ã€‚
- [x] ç›®å½•é¡µï¼šç« èŠ‚åˆ—è¡¨ã€å¿«é€Ÿè·³è½¬ã€å·/åˆ†ç»„ï¼ˆå¯é€‰ï¼‰ã€ç¼“å­˜çŠ¶æ€æç¤ºã€‚
- [x] é˜…è¯»å™¨åˆ†é¡µä¸ç¿»é¡µæ¨¡å¼ï¼šè‡³å°‘â€œæ»šåŠ¨ + è¦†ç›–â€ä¸¤ç§ï¼›åç»­è¡¥ä»¿çœŸ/æ»‘åŠ¨ã€‚
- [x] é˜…è¯»æ’ç‰ˆè®¾ç½®ï¼šå­—ä½“/å­—å·/è¡Œè·/æ®µè·/è¾¹è·/ä¸»é¢˜/å¤œé—´/å¯¹é½ç­‰ï¼Œæ”¯æŒæŒä¹…åŒ–ä¸å³æ—¶ç”Ÿæ•ˆã€‚
- [x] ä¹¦ç­¾ä¸é˜…è¯»å†å²ï¼šä¹¦ç­¾å¢åˆ æŸ¥ã€å†å²åˆ—è¡¨ã€ä»å†å²æ¢å¤è¿›åº¦ã€‚
- [x] å…¨æ–‡æœç´¢ï¼šåŸºäºæœ¬åœ°ç¼“å­˜ç« èŠ‚/æœ¬åœ°ä¹¦ç±çš„æœç´¢ï¼ˆä¸æœç´¢åœ¨çº¿å†…å®¹ï¼‰ã€‚
- [x] æ›¿æ¢å‡€åŒ–ï¼ˆReplaceRuleï¼‰ï¼šè§„åˆ™ç®¡ç†ï¼ˆåˆ†ç»„/æ’åº/å¯ç”¨ï¼‰+ æ›¿æ¢å¼•æ“ï¼ˆå«æ­£åˆ™ï¼‰+ é¢„è§ˆ/æµ‹è¯•ã€‚
- [ ] å›¾ç‰‡ç« èŠ‚åŸºç¡€æ”¯æŒï¼šæ­£æ–‡ä¸­å›¾ç‰‡æ¸²æŸ“ã€ç®€å•ç¼©æ”¾/æ ·å¼ï¼ˆå¦‚ `full`ï¼‰ç­–ç•¥ï¼ˆå½“å‰èŒƒå›´å¤–ï¼šä»…åšå°è¯´æ–‡æœ¬é˜…è¯»ï¼Œæš‚ä¸æ”¯æŒï¼‰ã€‚

### P3ï¼šç¦»çº¿ã€æœ¬åœ°ä¹¦ã€å¯¼å‡ºï¼ˆèƒ½åŠ›è¡¥å…¨ï¼‰

- [ ] ç¦»çº¿ç¼“å­˜ï¼šæŒ‰ç« èŠ‚æ‰¹é‡ä¸‹è½½ã€å¹¶å‘æ§åˆ¶ã€ç¼“å­˜ç®¡ç†é¡µï¼ˆæ¸…ç†/èŒƒå›´/å¤±è´¥é‡è¯•ï¼‰ã€‚
- [ ] å¯¼å‡ºï¼šå¯¼å‡º TXT/EPUBï¼ˆå«è‡ªå®šä¹‰å‘½åè§„åˆ™ï¼‰ï¼›å¯é€‰â€œå¯¼å‡ºåˆ° WebDavâ€ã€‚
- [ ] æœ¬åœ°ä¹¦ï¼šTXT/EPUB å¯¼å…¥ï¼ˆæ–‡ä»¶é€‰æ‹©/æ‰«æï¼‰ï¼›ä¹¦æ¶ä¸­åŒºåˆ†æœ¬åœ°ä¸åœ¨çº¿ä¹¦ã€‚
- [ ] TXT ç›®å½•è§„åˆ™ï¼ˆTxtTocRuleï¼‰ï¼šè§„åˆ™ç®¡ç†ã€è‡ªåŠ¨è¯†åˆ«å¼€å…³ã€ç½‘ç»œå¯¼å…¥ã€è¶…é•¿ç« èŠ‚æ‹†åˆ†ã€‚
- [ ] ä¹¦ç±å­˜å‚¨ä½ç½®è®¾ç½®ï¼šå…¼å®¹ Android å­˜å‚¨æƒé™/åˆ†åŒºå­˜å‚¨ï¼›iOS æ–‡ä»¶è®¿é—®ç­–ç•¥ã€‚

### P4ï¼šè®¢é˜…ã€åŒæ­¥ã€å¯¹å¤–æ¥å£ï¼ˆç”Ÿæ€èƒ½åŠ›ï¼‰

- [ ] RSS/è®¢é˜…ï¼šè®¢é˜…æºç®¡ç†ï¼ˆå¯¼å…¥/å¯åœ/å¯¼å‡º/åˆ†äº«ï¼‰ã€æ–‡ç« åˆ—è¡¨/é˜…è¯»/æ”¶è—/è®°å½•ã€‚
- [ ] å¬ä¹¦ï¼šç³»ç»Ÿ TTS + åå°æœ—è¯»ï¼›åœ¨çº¿æœ—è¯»å¼•æ“ï¼ˆHttpTTS è§„åˆ™ï¼š`speakText/speakSpeed`ï¼‰ã€‚
- [ ] å­—å…¸/ç¿»è¯‘ï¼šé€‰æ‹©æ–‡å­—èœå• + DictRuleï¼ˆ`urlRule` + `showRule`ï¼‰ã€‚
- [ ] å¤‡ä»½ä¸æ¢å¤ï¼šæœ¬åœ°å¤‡ä»½ï¼›WebDav äº‘å¤‡ä»½ï¼ˆè‡ªåŠ¨å¤‡ä»½ã€å†å²ç®¡ç†ã€æ¢å¤é€‰æ‹©ï¼‰ã€‚
- [ ] æœ¬åœ° Web API / WebSocketï¼šä¼˜å…ˆå…¼å®¹ Legado å¸¸ç”¨æ¥å£ï¼ˆä¹¦æº/ä¹¦æ¶/ç« èŠ‚/æ­£æ–‡/è¿›åº¦/æ›¿æ¢è§„åˆ™ï¼‰ã€‚
- [ ] URL Schemeï¼šå…¼å®¹ `legado://import/{path}?src=...` çš„æ ¸å¿ƒå¯¼å…¥ç±»å‹ï¼ˆbookSource/rssSource/replaceRule/textTocRule/httpTTS/theme/readConfig/dictRule/addToBookshelfï¼‰ã€‚
- [ ] Web ç«¯ï¼šWeb ä¹¦æ¶ + Web æºç¼–è¾‘ï¼ˆä¾èµ–æœ¬åœ° API å…ˆè½åœ°ï¼›å¯é€‰ï¼‰ã€‚

### å¯é€‰/ä½ä¼˜å…ˆçº§ï¼ˆè§†ç›®æ ‡ä¸èµ„æºè£å‰ªï¼‰

- [ ] ä¹¦æºâ€œæ ¡éªŒâ€å®Œæ•´å¯¹é½ï¼ˆç»†åˆ†å¤±è´¥åŸå› ã€è‡ªåŠ¨ç­›é€‰å¤±æ•ˆæºã€æ ¡éªŒå…³é”®è¯ç­–ç•¥ï¼‰ã€‚
- [ ] ç™»å½• UI/éªŒè¯ç /å†…ç½®æµè§ˆå™¨ï¼ˆWebViewï¼‰æ·±åº¦å¯¹é½ï¼ˆè§„åˆ™å¯è°ƒç”¨æµè§ˆå™¨ç­‰å¾…ç»“æœï¼‰ã€‚
- [ ] ä»£ç†é…ç½® UIï¼ˆHTTP/Socksï¼‰ã€è´­ä¹°/è·³è½¬ç­‰è¾¹ç¼˜è§„åˆ™æ‰©å±•ã€‚
- [ ] å­—ä½“åæ··æ·†ã€å›¾ç‰‡/å°é¢è§£å¯†ç­‰é«˜çº§è§„åˆ™æ‰©å±•ï¼ˆåªåœ¨é‡åˆ°çœŸå®ä¹¦æºå¼ºä¾èµ–æ—¶ä¼˜å…ˆå®ç°ï¼‰ã€‚

---

## 11. å·²å®ç°æ¨¡å—å¯¹ç…§å®¡æŸ¥ï¼ˆ2026-02-11ï¼‰

> ç›®æ ‡ï¼šæŒ‰â€œå‰é¢æ¨¡å—ä¸€ä¸ªä¸€ä¸ªè¿‡ä¸€éâ€æ‰§è¡Œæºç å¯¹ç…§å®¡æŸ¥ï¼›å½“å‰é˜¶æ®µåªè¦†ç›–**æ–‡æœ¬å°è¯´**èŒƒå›´ã€‚

### 11.1 ä¹¦æ¶ï¼ˆBookshelfï¼‰

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/ui/main/bookshelf/style2/BooksAdapterList.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/main/bookshelf/BookshelfViewModel.kt`
- å½“å‰ç»“è®ºï¼šå·²å®ç°â€œæœ€è¿‘é˜…è¯»æ’åº + ç»§ç»­é˜…è¯» + ç§»é™¤â€ï¼›æœªåšåˆ†ç»„ã€æœªè¯»è§’æ ‡ã€æ›´æ–°ä¸­åŠ¨ç”»ã€‚
- å¤„ç†ï¼šç°é˜¶æ®µæ¥å—å·®å¼‚ï¼ˆMVP å¯ç”¨ï¼‰ï¼Œåç»­åœ¨ P2 è¡¥é½åˆ†ç»„ä¸æœªè¯»çŠ¶æ€ã€‚

### 11.2 é˜…è¯»è¿›åº¦å†™å›ä¸æ¢å¤

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/model/ReadBook.kt`ï¼ˆ`saveRead()`ï¼‰
- å½“å‰ç»“è®ºï¼šå·²å†™å› `durChapterIndex/durChapterPos/durChapterTime` å¹¶æ¢å¤ï¼›å·²è¡¥é½â€œæœ¬åœ°ç¼“å­˜å‘½ä¸­åˆ†æ”¯â€ä¹Ÿä¼šæ›´æ–°è¿›åº¦ä¸çŠ¶æ€ã€‚
- å¤„ç†ï¼šä¸€è‡´æ€§æ»¡è¶³å½“å‰é˜¶æ®µç›®æ ‡ã€‚

### 11.3 ç›®å½•é¢æ¿

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/ui/book/read/ReadMenu.kt`
- å½“å‰ç»“è®ºï¼šå·²æ”¯æŒç« èŠ‚åˆ—è¡¨ã€æ ‡é¢˜æœç´¢ã€é¦–ç« /å½“å‰/æœ«ç« è·³è½¬ã€ç¼“å­˜çŠ¶æ€æç¤ºã€‚
- å¤„ç†ï¼šä¿æŒç°çŠ¶ï¼Œåç»­å†è¡¥æ›´ç»†çš„ç›®å½•åˆ†ç»„ä¸é«˜çº§äº¤äº’ã€‚

### 11.4 é˜…è¯»æ’ç‰ˆä¸èœå•

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/ui/book/read/ReadMenu.kt`
- å½“å‰ç»“è®ºï¼šå·²æ”¯æŒä¸»é¢˜ã€å­—å·ã€è¡Œè·ã€äº®åº¦ã€ç‚¹å‡»ç¿»é¡µã€åº•éƒ¨èœå•å¸ƒå±€ä¸æŒä¹…åŒ–ã€‚
- å¤„ç†ï¼šåœ¨â€œä»…å°è¯´â€èŒƒå›´å†…ä¿æŒä¸€è‡´ï¼›æœ—è¯»å…¥å£æš‚ç”±ä¹¦ç­¾å…¥å£æ›¿ä»£å¹¶åœ¨åç»­è¡¥å›ã€‚

### 11.5 ä¹¦ç±è¯¦æƒ…æµï¼ˆruleBookInfoï¼‰

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/model/webBook/BookInfo.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/info/BookInfoActivity.kt`
  - `../legado/app/src/main/java/io/legado/app/data/entities/rule/BookInfoRule.kt`
- å½“å‰ç»“è®ºï¼šå·²æ‰“é€šâ€œå‘ç° -> è¯¦æƒ… -> å…¥ä¹¦æ¶ -> é˜…è¯»â€ä¸»æµç¨‹ï¼Œæ”¯æŒ `ruleBookInfo` åŸºç¡€å­—æ®µï¼ˆname/author/intro/coverUrl/tocUrlï¼‰è§£æã€‚
- å·®å¼‚ï¼šæœªè¦†ç›– Legado çš„ `init/canReName/kind/lastChapter/wordCount/downloadUrls` ç­‰å®Œæ•´å­—æ®µã€‚
- å¤„ç†ï¼šä¸»æµç¨‹ä¼˜å…ˆï¼Œå…ˆä¿æŒåŸºç¡€å­—æ®µï¼›æ‰©å±•å­—æ®µåç½®åˆ°è§„åˆ™å¼•æ“å¯¹é½é˜¶æ®µã€‚

### 11.6 å…¨æ–‡æœç´¢ï¼ˆæœ¬åœ°ç¼“å­˜ï¼‰

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/ui/book/searchContent/SearchContentActivity.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/searchContent/SearchContentViewModel.kt`
- å½“å‰ç»“è®ºï¼šå·²æ”¯æŒæŒ‰ç¼“å­˜ç« èŠ‚æœç´¢ã€å‘½ä¸­æ¬¡æ•°ã€ç‰‡æ®µé¢„è§ˆã€ç‚¹å‡»è·³ç« ã€‚
- è¿›å±•æ›´æ–°ï¼šå·²è¡¥é½â€œå‘½ä¸­ä½ç½®é«˜äº® + ç« èŠ‚å†…å‘½ä¸­ç´¢å¼•å®šä½â€ï¼›æ»šåŠ¨æ¨¡å¼ä¸‹æ”¯æŒè·³è½¬åè‡ªåŠ¨æ»šåŠ¨åˆ°ç›®æ ‡å‘½ä¸­ä½ç½®ã€‚
- å·®å¼‚ï¼šè¦†ç›–æ¨¡å¼ä¸‹ä»…åšå…³é”®è¯é«˜äº®ï¼Œä¸åšç²¾ç¡®å‘½ä¸­æ»šåŠ¨å®šä½ï¼ˆå½“å‰é˜¶æ®µå¯æ¥å—ï¼‰ã€‚

### 11.7 æ›¿æ¢å‡€åŒ–ï¼ˆReplaceRuleï¼‰

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/help/ReplaceAnalyzer.kt`
  - `../legado/app/src/main/java/io/legado/app/help/book/ContentProcessor.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/read/EffectiveReplacesDialog.kt`
- å½“å‰ç»“è®ºï¼šå·²å…·å¤‡è§„åˆ™å¢åˆ ã€å¯åœã€æ­£åˆ™/æ–‡æœ¬æ›¿æ¢ã€å½“å‰ç« é¢„è§ˆã€‚
- å·®å¼‚ï¼šæœªåš scope/group/orderã€æœ‰æ•ˆè§„åˆ™åˆ—è¡¨ä¸å…¨å±€è§„åˆ™ç®¡ç†é¡µã€‚
- å¤„ç†ï¼šä¿ç•™å½“å‰æœ€å°é—­ç¯ï¼Œåç»­é€æ­¥è¡¥é½ã€‚

### 11.8 ä¹¦ç­¾ä¸å†å²

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/data/entities/Bookmark.kt`
  - `../legado/app/src/main/java/io/legado/app/data/entities/ReadRecord.kt`
  - `../legado/app/src/main/java/io/legado/app/data/dao/ReadRecordDao.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/toc/BookmarkFragment.kt`
- å½“å‰ç»“è®ºï¼šå·²æ”¯æŒä¹¦ç­¾å¢åˆ ä¸å†å²è·³è½¬ï¼›æœ¬è½®æ”¹ä¸ºâ€œæŒ‰ä¹¦éš”ç¦»â€æŒä¹…åŒ–ï¼Œé¿å…è·¨ä¹¦ä¸²æ•°æ®ã€‚
- å·®å¼‚ï¼šå°šæœªå¯¹é½ legado çš„é˜…è¯»æ—¶é•¿ç»Ÿè®¡ä½“ç³»ï¼ˆ`ReadRecord` èšåˆï¼‰ã€‚
- å¤„ç†ï¼šé˜¶æ®µæ€§æ¥å—å·®å¼‚ï¼Œåç»­æ–°å¢ç»Ÿè®¡é¡µæ—¶è¡¥é½ã€‚

### 11.9 ç¿»é¡µæ¨¡å¼ï¼ˆæ»šåŠ¨/è¦†ç›–ï¼‰

- legado å¯¹ç…§ï¼š
  - `../legado/app/src/main/java/io/legado/app/ui/book/read/page/ReadView.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/read/page/delegate/CoverPageDelegate.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/read/page/delegate/ScrollPageDelegate.kt`
- å½“å‰ç»“è®ºï¼šå·²æä¾›æ»šåŠ¨ + è¦†ç›–ä¸¤ç§å¯åˆ‡æ¢æ¨¡å¼å¹¶æŒä¹…åŒ–ã€‚
- å·®å¼‚ï¼šå½“å‰è¦†ç›–æ¨¡å¼ä¸ºæ–‡æœ¬åˆ‡ç‰‡åˆ†é¡µï¼Œæœªè¾¾åˆ° legado çš„æ¸²æŸ“ä»£ç†çº§åˆ†é¡µç²¾åº¦ã€‚
- å¤„ç†ï¼šæ˜ç¡®ä¸ºâ€œå½“å‰é˜¶æ®µç®€åŒ–å®ç°â€ï¼Œåç»­å†åšç²¾ç»†åˆ†é¡µå¼•æ“ã€‚

### 11.10 èŒƒå›´è¾¹ç•Œç¡®è®¤ï¼ˆå½“å‰é˜¶æ®µï¼‰

- ä»…åšæ–‡æœ¬å°è¯´é˜…è¯»ï¼›æ¼«ç”»/å›¾ç‰‡ç« èŠ‚ç›¸å…³èƒ½åŠ›æš‚ä¸å®ç°ã€‚
- å› æ­¤ä¸å¯¹é½ legado çš„å›¾ç‰‡ç« èŠ‚æ ·å¼ã€ç¼©æ”¾ã€ç›¸å…³æ»šåŠ¨ç­–ç•¥ã€‚

---

## 12. legado æ–‡ä»¶çº§è¿ç§»å°è´¦ï¼ˆä¸»æµç¨‹ä¼˜å…ˆï¼‰

### 12.1 è¿ç§»æ‰§è¡Œè§„åˆ™

- æ¯ä¸ªåŠŸèƒ½æŒ‰â€œå…ˆå®šä½ legado æºç  -> å† Flutter å®ç° -> å†è®°å½•å·®å¼‚â€æ‰§è¡Œã€‚
- æ¯æ¬¡åªè¿ç§»å°‘é‡å…³é”®æ–‡ä»¶ï¼Œä¼˜å…ˆä¿è¯ä¸»æµç¨‹å¯ç”¨ä¸å¯å›å½’ã€‚
- å½“å‰é˜¶æ®µä»…è¦†ç›–æ–‡æœ¬å°è¯´èƒ½åŠ›ï¼›æ¼«ç”»/å›¾ç‰‡ç« èŠ‚ç›¸å…³æ–‡ä»¶å…¨éƒ¨åç½®ã€‚

### 12.2 å½“å‰æ‰¹æ¬¡ï¼ˆP0ï¼‰

| ä¼˜å…ˆçº§ | legado æ–‡ä»¶ | Flutter å¯¹åº”æ–‡ä»¶ | çŠ¶æ€ | å¤‡æ³¨ |
|---|---|---|---|---|
| P0 | `app/model/webBook/BookInfo.kt` | `lib/legado/model/web_book/book_info.dart` | âœ… å·²è¿ç§» | æ–°å¢ `LegadoBookInfoAnalyzer`ï¼Œè¦†ç›– `init/name/author/intro/kind/wordCount/lastChapter/updateTime/coverUrl/tocUrl/downloadUrls/canReName` åŸºç¡€è§£æ |
| P0 | `app/model/webBook/WebBook.kt`ï¼ˆ`getBookInfoAwait`ï¼‰ | `lib/features/reader/domain/services/legado_reader_service.dart` | âœ… å·²å¯¹é½ä¸»å¹² | è¯¦æƒ…æŠ“å–å…¥å£æ”¹ä¸ºè°ƒç”¨ `BookInfo` åˆ†æå™¨ï¼›ä¿ç•™â€œæŠ“å–å¤±è´¥å…œåº•â€ç­–ç•¥ |
| P0 | `app/ui/book/info/BookInfoActivity.kt` | `lib/features/discovery/presentation/book_detail_page.dart` | âœ… ä¸»æµç¨‹å®Œæˆ | è¯¦æƒ…å±•ç¤º + å…¥ä¹¦æ¶ + åŠ å…¥å¹¶é˜…è¯»å·²æ‰“é€šï¼Œå¤æ‚èœå•èƒ½åŠ›åç½® |

### 12.3 ä¸‹ä¸€æ‰¹ï¼ˆP1ï¼‰

| ä¼˜å…ˆçº§ | legado æ–‡ä»¶ | Flutter ç›®æ ‡æ–‡ä»¶ | çŠ¶æ€ | å¤‡æ³¨ |
|---|---|---|---|---|
| P1 | `app/model/webBook/BookChapterList.kt` | `lib/legado/model/web_book/book_chapter_list.dart` | âœ… å·²è¿ç§»ï¼ˆä¸»æµç¨‹ï¼‰ | ç›®å½•è§„åˆ™è§£æå·²ä» `LegadoReaderService` æŠ½ç¦»åˆ° legado æ¨¡å—ç›®å½• |
| P1 | `app/model/webBook/BookContent.kt` | `lib/legado/model/web_book/book_content.dart` | âœ… å·²è¿ç§»ï¼ˆä¸»æµç¨‹ï¼‰ | æ­£æ–‡è§„åˆ™è§£æå·²ä»æœåŠ¡å±‚æŠ½ç¦»ï¼Œæ”¯æŒ JSON/HTML åŸºç¡€è·¯å¾„ |
| P1 | `app/model/webBook/WebBook.kt`ï¼ˆ`getChapterListAwait/getContentAwait`ï¼‰ | `lib/features/reader/domain/services/legado_reader_service.dart` | âœ… ä¸»æµç¨‹å·²å¯¹é½ | æœåŠ¡å±‚å½“å‰ä»…è´Ÿè´£ç¼–æ’è¯·æ±‚ä¸ç»“æœå…¥åº“ï¼Œè§£æèŒè´£å·²ä¸‹æ²‰ |


### 12.4 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆ2026-02-11ï¼‰

- âœ… å·²æ–°å¢ `lib/legado/model/web_book/book_chapter_list.dart`ï¼Œå¯¹é½ `BookChapterList.kt` çš„â€œç›®å½•è§„åˆ™è§£æâ€èŒè´£ï¼ˆå½“å‰å…ˆè¦†ç›–ä¸»æµç¨‹æ‰€éœ€ JSON è·¯å¾„åœºæ™¯ï¼‰ã€‚
- âœ… å·²æ–°å¢ `lib/legado/model/web_book/book_content.dart`ï¼Œå¯¹é½ `BookContent.kt` çš„â€œæ­£æ–‡è§„åˆ™è§£æâ€èŒè´£ï¼ˆå½“å‰å…ˆè¦†ç›–ä¸»æµç¨‹æ‰€éœ€ JSON/HTML åŸºç¡€è·¯å¾„åœºæ™¯ï¼‰ã€‚
- âœ… `LegadoReaderService` å·²æ”¹ä¸ºâ€œæµç¨‹ç¼–æ’å±‚â€ï¼Œç›®å½•ä¸æ­£æ–‡è§£æä¸‹æ²‰åˆ° `lib/legado/model/web_book/*`ã€‚


### 12.5 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆWebBook ç¼–æ’å±‚ï¼‰

- âœ… å·²æ–°å¢ `lib/legado/model/web_book/web_book.dart`ï¼Œå¯¹åº” legado `WebBook.kt` çš„ä¸»æµç¨‹ç¼–æ’èŒè´£ï¼ˆè¯¦æƒ…/ç›®å½•/æ­£æ–‡è·å–ï¼‰ã€‚
- âœ… `lib/features/reader/domain/services/legado_reader_service.dart` è¿›ä¸€æ­¥æ”¶æ•›ä¸ºåº”ç”¨å±‚æœåŠ¡ï¼Œåº•å±‚æŠ“å–ä¸è§„åˆ™è§£æç»Ÿä¸€å§”æ‰˜ `LegadoWebBook`ã€‚
- âœ… ç›®å½•é“¾è·¯æ–°å¢ `tocUrl` å›é€€ç­–ç•¥ï¼šå½“ `ruleToc.url` ç¼ºå¤±æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ä¹¦ç±å·²è§£æåˆ°çš„ `tocUrl`ã€‚


### 12.6 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆBookList / æœç´¢é“¾è·¯ï¼‰

- âœ… å·²æ–°å¢ `lib/legado/model/web_book/book_list.dart`ï¼Œå¯¹åº” legado `BookList.kt` çš„æœç´¢åˆ—è¡¨è§£æèŒè´£ï¼ˆå½“å‰è¦†ç›– JSON/HTML ä¸»æµç¨‹è§„åˆ™å­é›†ï¼‰ã€‚
- âœ… `lib/legado/model/web_book/web_book.dart` å·²æ–°å¢ `searchBook(...)`ï¼Œç”± WebBook ç»Ÿä¸€æ‰¿æ¥æœç´¢è¯·æ±‚ä¸åˆ—è¡¨è§£æã€‚
- âœ… `lib/features/discovery/domain/services/legado_search_service.dart` æ”¹ä¸ºè°ƒç”¨ `LegadoWebBook.searchBook(...)`ï¼Œå‘ç°æœç´¢é“¾è·¯ä¸ legado æ¨¡å—å±‚çº§å¯¹é½ã€‚
- âœ… æ–°å¢å•æµ‹ `test/legado/model/web_book/book_list_analyzer_test.dart`ï¼Œè¦†ç›– JSON/HTML è§£æä¸åˆ—è¡¨åè½¬è¡Œä¸ºã€‚


### 12.7 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆruleExplore / å‘ç°é“¾è·¯ï¼‰

- âœ… `lib/legado/model/web_book/web_book.dart` æ–°å¢ `exploreBook(...)`ï¼ŒæŒ‰ legado `WebBook.exploreBookAwait` è§’è‰²æ‰¿æ¥å‘ç°è¯·æ±‚ã€‚
- âœ… `lib/features/discovery/domain/services/legado_search_service.dart` æ–°å¢ `explore(...)`ï¼Œæ”¯æŒæŒ‰ `exploreUrl + ruleExplore` èšåˆå‘ç°ç»“æœã€‚
- âœ… `lib/features/discovery/presentation/discovery_page.dart` æ–°å¢â€œåŠ è½½å‘ç°æ¨èâ€å…¥å£ï¼Œä¸»æµç¨‹å¯ç›´æ¥éªŒè¯ `ruleExplore`ã€‚
- âœ… `lib/core/network/mock_legado_api.dart` ä¸å†…ç½®ç¤ºä¾‹ä¹¦æºè¡¥é½ `mock://explore`ã€`exploreUrl`ã€`ruleExplore`ã€‚
- âœ… æ–°å¢æµ‹è¯• `test/features/discovery/legado_search_service_test.dart`ï¼Œè¦†ç›– `search` ä¸ `explore` ä¸¤æ¡é“¾è·¯ã€‚


### 12.8 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆexploreKinds / å‘ç°åˆ†ç±»ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/java/io/legado/app/help/source/BookSourceExtensions.kt` ä¸ `../legado/app/src/main/java/io/legado/app/data/entities/rule/ExploreKind.kt`ã€‚
- âœ… å·²æ–°å¢ `lib/legado/model/web_book/explore_kinds.dart`ï¼ŒæŒ‰ legado å…¼å®¹ä¸¤ç±»å‘ç°åˆ†ç±»æ ¼å¼ï¼šJSON æ•°ç»„ã€`title::url`ï¼ˆæ”¯æŒ `&&` / æ¢è¡Œåˆ†éš”ï¼‰ã€‚
- âœ… å·²æ‰©å±• `lib/legado/model/web_book/web_book.dart`ï¼šæ–°å¢ `getExploreKinds(...)`ï¼Œå¹¶åœ¨ `exploreBook(...)` é»˜è®¤ URL é€‰æ‹©ä¸­ä¼˜å…ˆå¤ç”¨åˆ†ç±»è§£æç»“æœã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/domain/services/legado_search_service.dart`ï¼šæ–°å¢ `getExploreKinds(...)`ï¼ŒæŒ‰ä¹¦æºèšåˆå‘ç°åˆ†ç±»ã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/presentation/discovery_page.dart`ï¼šæ–°å¢â€œåŠ è½½å‘ç°åˆ†ç±»â€å…¥å£ä¸åˆ†ç±»ç‚¹å‡»åŠ è½½èƒ½åŠ›ï¼ˆä¸å½±å“æ—¢æœ‰æœç´¢/æ¨èæŒ‰é’®ï¼‰ã€‚
- âœ… å·²è¡¥é½ `mock://` ç¤ºä¾‹ï¼š`lib/core/network/mock_legado_api.dart` æ–°å¢ `mock://explore-hot`ï¼Œ`Settings` å†…ç½®ç¤ºä¾‹æºæ”¹ä¸ºå¤šåˆ†ç±» `exploreUrl`ã€‚
- âœ… å·²æ–°å¢æµ‹è¯• `test/legado/model/web_book/explore_kinds_test.dart`ï¼Œå¹¶æ‰©å±• `test/features/discovery/legado_search_service_test.dart` è¦†ç›–åˆ†ç±»åˆ—è¡¨ä¸æŒ‰åˆ†ç±»åŠ è½½ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼š`<js>` / `@js:` åŠ¨æ€åˆ†ç±»æš‚æœªæ‰§è¡Œï¼Œå½“å‰é˜¶æ®µæŒ‰â€œä¸»æµç¨‹ä¼˜å…ˆ + ä»…æ–‡æœ¬å°è¯´â€ç»§ç»­åç½®ã€‚

### 12.9 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆExploreKind.style / exploreScreen æ ·å¼å¯¹é½ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/java/io/legado/app/data/entities/rule/FlexChildStyle.kt` ä¸ `../legado/app/src/main/assets/web/help/md/ruleHelp.md` çš„å‘ç° `style` ç¤ºä¾‹ã€‚
- âœ… å·²æ‰©å±• `lib/legado/model/web_book/explore_kinds.dart`ï¼šæ–°å¢ `LegadoFlexChildStyle`ï¼Œæ”¯æŒä» `exploreUrl` çš„ JSON åˆ†ç±»é¡¹è§£æ `style`ã€‚
- âœ… å·²æ‰©å±• `lib/legado/model/web_book/web_book.dart`ï¼š`getExploreKinds(...)` ä¼šæŠŠ `source.exploreScreen` è§£æä¸ºæ ·å¼æ˜ å°„ï¼Œå¹¶å¯¹æœªæ˜¾å¼é…ç½® `style` çš„åˆ†ç±»åšæ ·å¼è¡¥é½ã€‚
- âœ… å·²æ‰©å±•å‘ç°åŸŸæ¨¡å‹ `lib/features/discovery/domain/models/explore_kind_entity.dart`ï¼Œé€ä¼ æ ·å¼å­—æ®µåˆ° UI å±‚ã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/presentation/discovery_page.dart`ï¼šåˆ†ç±»æŒ‰é’®æ”¯æŒ `layout_flexBasisPercent / layout_alignSelf / layout_wrapBefore` çš„ Flutter è¿‘ä¼¼æ¸²æŸ“ã€‚
- âœ… å·²æ›´æ–°å†…ç½®ç¤ºä¾‹æº `lib/features/settings/presentation/settings_page.dart`ï¼šä½¿ç”¨ JSON `exploreUrl` + `exploreScreen`ï¼Œå¯ç›´æ¥éªŒè¯æ ·å¼æ•ˆæœã€‚
- âœ… å·²æ‰©å±•æµ‹è¯•ï¼š
  - `test/legado/model/web_book/explore_kinds_test.dart` æ–°å¢æ ·å¼è§£æä¸ `exploreScreen` æ˜ å°„è¦†ç›–ã€‚
  - `test/features/discovery/legado_search_service_test.dart` æ–°å¢åˆ†ç±»æ ·å¼é€ä¼ è¦†ç›–ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼š`layout_flexGrow/layout_flexShrink` åœ¨ Flutter `Wrap` ä¸­ä»…ä¿ç•™å­—æ®µä¸é€ä¼ ï¼Œå½“å‰æœªåšå®Œå…¨ç­‰ä»·å¸ƒå±€å¼•æ“ã€‚

### 12.10 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆåˆ†ç±»ç‚¹å‡»æŒ‰ä¹¦æºåŠ è½½ + å‘ç°ç»“æœä¿¡æ¯è¡¥é½ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/java/io/legado/app/ui/book/explore/ExploreShowViewModel.kt` ä¸ `ExploreShowActivity.kt`ï¼Œç¡®è®¤â€œè¿›å…¥åˆ†ç±»åæŒ‰å•ä¸€ä¹¦æº + æŒ‡å®š exploreUrl æ‹‰å–â€çš„è¡Œä¸ºè¾¹ç•Œã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/domain/services/legado_search_service.dart`ï¼š`explore(...)` æ–°å¢ `sourceUrl` å‚æ•°ï¼›å½“ä¼ å…¥æ—¶ä»…è¯·æ±‚è¯¥ä¹¦æºï¼Œé¿å…å¤šä¹¦æºä¸²æµã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/presentation/discovery_page.dart`ï¼šåˆ†ç±»æŒ‰é’®ç‚¹å‡»æ—¶ä¼ å…¥å½“å‰åˆ†ç»„ `sourceUrl`ï¼Œè¡Œä¸ºä¸ legado çš„åˆ†ç±»è¿›å…¥ä¸€è‡´ã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/domain/models/search_result_entity.dart`ï¼šè¡¥é½ `kind/wordCount/latestChapter` å­—æ®µï¼Œä¾¿äºå‘ç°åˆ—è¡¨å±•ç¤ºæ›´å¤šä¿¡æ¯ã€‚
- âœ… å·²æ‰©å±•å‘ç°ç»“æœå¡ç‰‡ï¼šå±•ç¤ºâ€œæœ€æ–°ç« èŠ‚/åˆ†ç±»/å­—æ•°/ç®€ä»‹æ‘˜è¦â€ï¼ˆæœ‰å€¼æ‰æ˜¾ç¤ºï¼‰ï¼Œä¿æŒä¸»æµç¨‹æ“ä½œå…¥å£ä¸å˜ã€‚
- âœ… å·²æ‰©å±•æµ‹è¯• `test/features/discovery/legado_search_service_test.dart`ï¼šæ–°å¢â€œæŒ‰åˆ†ç±»ç‚¹å‡»ä»…è¯·æ±‚ç›®æ ‡ä¹¦æºâ€å›å½’ç”¨ä¾‹ï¼Œå¹¶è¡¥å……å­—æ®µé€ä¼ è¦†ç›–ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šå½“å‰å‘ç°ç»“æœä»èµ°å•é¡µèšåˆè§†å›¾ï¼Œå°šæœªæ‹†åˆ†ä¸º legado çš„ç‹¬ç«‹ `ExploreShowActivity` + ä¸Šæ‹‰åˆ†é¡µåŠ è½½ä½“éªŒã€‚

### 12.11 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆç‹¬ç«‹å‘ç°ç»“æœé¡µ + ä¸Šæ‹‰åˆ†é¡µï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/java/io/legado/app/ui/book/explore/ExploreShowActivity.kt`ã€`ExploreShowViewModel.kt`ã€`ExploreShowAdapter.kt`ã€‚
- âœ… å·²æ–°å¢ç‹¬ç«‹é¡µé¢ `lib/features/discovery/presentation/explore_results_page.dart`ï¼šç”¨äºæ‰¿æ¥å‘ç°åˆ†ç±»ç»“æœå±•ç¤ºï¼Œæ”¯æŒæ»šåŠ¨è§¦åº•è‡ªåŠ¨åŠ è½½ä¸‹ä¸€é¡µã€‚
- âœ… å·²åœ¨ `lib/app/router.dart` æ–°å¢è·¯ç”± `/discovery/explore-results`ï¼Œå¹¶é€šè¿‡ `extra` ä¼ é€’ `title/sourceUrl/sourceName/exploreUrl`ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/discovery_page.dart`ï¼š
  - â€œåŠ è½½å‘ç°æ¨èâ€æ”¹ä¸ºè·³è½¬ç‹¬ç«‹å‘ç°ç»“æœé¡µï¼›
  - åˆ†ç±»æŒ‰é’®æ”¹ä¸ºè·³è½¬ç‹¬ç«‹å‘ç°ç»“æœé¡µå¹¶ä¼ å…¥å½“å‰ä¹¦æºä¸åˆ†ç±» URLã€‚
- âœ… ç‹¬ç«‹å‘ç°ç»“æœé¡µæ”¯æŒï¼š
  - é¦–å±åŠ è½½ã€åŠ è½½å¤±è´¥é‡è¯•ã€è§¦åº•åˆ†é¡µã€æ— æ›´å¤šæç¤ºï¼›
  - ç»“æœå¡ç‰‡æ˜¾ç¤ºæœ€æ–°ç« èŠ‚/åˆ†ç±»/å­—æ•°/ç®€ä»‹ï¼›
  - æŸ¥çœ‹è¯¦æƒ…ã€åŠ å…¥å¹¶é˜…è¯»å…¥å£ã€‚
- âœ… `SearchResultEntity` å­—æ®µå·²è¡¥é½åˆ°å‘ç°å±•ç¤ºæ‰€éœ€ï¼ˆ`kind/wordCount/latestChapter`ï¼‰ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šå½“å‰æœªå®ç°â€œä¹¦æ¶åœ¨æ¶çŠ¶æ€â€è§’æ ‡è”åŠ¨ï¼ˆ`isInBookshelf` å®æ—¶åˆ·æ–°ï¼‰ï¼Œå…ˆä¿è¯ä¸»æµç¨‹ä¸åˆ†é¡µå¯ç”¨ã€‚

### 12.12 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆå‘ç°ç»“æœåœ¨æ¶çŠ¶æ€è”åŠ¨ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/java/io/legado/app/ui/book/explore/ExploreShowAdapter.kt`ï¼ˆ`isInBookshelf` è§’æ ‡é€»è¾‘ï¼‰ä¸ `ExploreShowViewModel.kt`ï¼ˆä¹¦æ¶é›†åˆæ›´æ–°ï¼‰ã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - è®¢é˜… `watchBookshelf()`ï¼Œå®æ—¶ç»´æŠ¤å‘ç°ç»“æœé¡µçš„åœ¨æ¶æ ‡è¯†é›†åˆï¼›
  - é‡‡ç”¨ `name-author / name / bookUrl` ä¸‰ç±» key ä¸ legado ä¸€è‡´åšåŒ¹é…ï¼›
  - ç»“æœå¡ç‰‡æ–°å¢â€œå·²åœ¨ä¹¦æ¶â€çŠ¶æ€æç¤ºä¸æŒ‰é’®æ–‡æ¡ˆåˆ‡æ¢ï¼ˆ`ç»§ç»­é˜…è¯»/å¿«é€Ÿé˜…è¯»`ï¼‰ã€‚
- âœ… é¡µé¢ç”Ÿå‘½å‘¨æœŸå·²å¤„ç†ï¼šç¦»å¼€é¡µé¢æ—¶å–æ¶ˆä¹¦æ¶è®¢é˜…ï¼Œé¿å…èµ„æºæ³„éœ²ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šå½“å‰â€œç»§ç»­é˜…è¯»â€ä»å¤ç”¨â€œåŠ å…¥å¹¶é˜…è¯»â€æµç¨‹ï¼ˆå¹‚ç­‰ upsertï¼‰ï¼Œåç»­å¯å†ç»†åŒ–ä¸ºç›´æ¥è¯»å–ä¹¦æ¶å·²å­˜ä¹¦ç±æ‰“å¼€ã€‚

### 12.13 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆç»§ç»­é˜…è¯»ç›´å¼€ä¹¦æ¶è®°å½•ï¼‰

- âœ… å·²åœ¨ `lib/features/discovery/presentation/explore_results_page.dart` å¯¹â€œå·²åœ¨ä¹¦æ¶â€åœºæ™¯åšè¡Œä¸ºå¯¹é½ï¼š
  - å…ˆæŸ¥è¯¢æœ¬åœ°ä¹¦æ¶å¹¶åŒ¹é…å·²å­˜ä¹¦ç±ï¼ˆ`name-author / name / bookUrl`ï¼‰ï¼›
  - å‘½ä¸­åç›´æ¥è¿›å…¥é˜…è¯»é¡µï¼Œä¸å†ç»è¿‡â€œåŠ å…¥ä¹¦æ¶â€å†™å…¥æµç¨‹ã€‚
- âœ… æœªå‘½ä¸­æ—¶ä¿æŒåŸè¡Œä¸ºï¼šæ‰§è¡ŒåŠ å…¥ä¹¦æ¶å¹¶è¿›å…¥é˜…è¯»ï¼Œä¿è¯å…¼å®¹ã€‚
- âœ… â€œå·²åœ¨ä¹¦æ¶â€æŒ‰é’®æ–‡æ¡ˆä¿ç•™â€œç»§ç»­é˜…è¯»â€ï¼Œè¡Œä¸ºå·²ä¸æ–‡æ¡ˆä¸€è‡´ã€‚

### 12.14 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆå‘ç°ç»“æœå¡ç‰‡å¸ƒå±€ä¸äº¤äº’å¯¹é½ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/java/io/legado/app/ui/book/explore/ExploreShowAdapter.kt`ã€`../legado/app/src/main/res/layout/item_search.xml`ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - ç»“æœé¡¹æ”¹ä¸ºâ€œæ•´å¡ç‚¹å‡»è¿›å…¥è¯¦æƒ…â€ï¼Œä¸ legado çš„ item ç‚¹å‡»è¡Œä¸ºä¸€è‡´ï¼ˆè¯¦æƒ…æµç”± `BookDetailPage` æ‰¿æ¥ï¼‰ã€‚
  - å¡ç‰‡å¸ƒå±€è°ƒæ•´ä¸ºâ€œå·¦å°é¢ + å³ä¿¡æ¯â€ç»“æ„ï¼Œå°é¢å¯¹é½ä¸º `80x110` æ¯”ä¾‹ã€‚
  - ä¿ç•™å¹¶å¼ºåŒ– legado åŒæ¬¾æ ¸å¿ƒä¿¡æ¯ï¼šåœ¨æ¶ç»¿ç‚¹ã€ä¹¦åã€ä½œè€…ã€åˆ†ç±»æ ‡ç­¾ã€æœ€æ–°ç« èŠ‚ã€ç®€ä»‹æ‘˜è¦ã€‚
  - åˆ†é¡µåŠ è½½å¤±è´¥é‡è¯•æŒ‰é’®ç¦ç”¨æ¡ä»¶ä¼˜åŒ–ä¸ºä»…å—åŠ è½½çŠ¶æ€æ§åˆ¶ï¼Œé¿å…è¯¯ç¦ç”¨ã€‚
- âœ… å·²ç§»é™¤å‘ç°ç»“æœé¡µä¸­ä¸å±äº legado `ExploreShowAdapter` ä¸»èŒè´£çš„â€œé¡µå†…å¿«é€Ÿé˜…è¯»â€æ“ä½œï¼Œå‡å°‘ä¸è¯¦æƒ…é¡µèŒè´£é‡å ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼š
  - æš‚æœªåš `payload` å±€éƒ¨åˆ·æ–°ä¼˜åŒ–ï¼ˆå½“å‰ä¸º `setState` æ•´ä½“åˆ·æ–°ï¼ŒåŠŸèƒ½æ­£ç¡®ï¼‰ã€‚
  - `item_search.xml` ä¸­ `bv_originCount` è§’æ ‡åœ¨å½“å‰â€œå•ä¹¦æºåˆ†ç±»ç»“æœé¡µâ€åœºæ™¯æœªå¯ç”¨ï¼ˆé˜¶æ®µæ€§æ¥å—ï¼‰ã€‚

### 12.15 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆåœ¨æ¶çŠ¶æ€å±€éƒ¨åˆ·æ–°ï¼Œå¯¹é½ payload æ€è·¯ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/java/io/legado/app/ui/book/explore/ExploreShowActivity.kt` ä¸­ `notifyItemRangeChanged(..., payload)` ä¸ `ExploreShowAdapter.kt` çš„ `bindChange`ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - æ–°å¢ `_bookshelfVersion`ï¼ˆ`ValueNotifier<int>`ï¼‰ï¼Œä¹¦æ¶æµå˜åŒ–æ—¶ä»…é€’å¢ç‰ˆæœ¬å·ï¼Œä¸å† `setState` æ•´é¡µåˆ·æ–°ã€‚
  - å¡ç‰‡å†…â€œåœ¨æ¶ç»¿ç‚¹â€å’Œâ€œåœ¨æ¶æç¤ºæ–‡æ¡ˆâ€æ”¹ä¸º `ValueListenableBuilder` å±€éƒ¨é‡å»ºï¼Œè¡Œä¸ºä¸Šå¯¹é½ legado çš„ payload å±€éƒ¨æ›´æ–°æ€è·¯ã€‚
  - é¡µé¢é”€æ¯æ—¶è¡¥å…… `_bookshelfVersion.dispose()`ï¼Œé¿å…ç›‘å¬å¯¹è±¡æ³„éœ²ã€‚
- âœ… ç»“æœï¼šå‘ç°ç»“æœé¡µåœ¨ä¹¦æ¶çŠ¶æ€å˜åŒ–æ—¶ï¼Œä»…åˆ·æ–°å¿…è¦å­åŒºåŸŸï¼Œé¿å…åˆ—è¡¨æ•´ä½“é‡å»ºé€ æˆçš„é¢å¤–å¼€é”€ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šFlutter ç«¯ä»æœªå®ç° RecyclerView çº§åˆ«çš„ `payload` ç²¾ç»†èŒƒå›´æ›´æ–°ï¼›å½“å‰ä¸ºâ€œç»„ä»¶çº§å±€éƒ¨é‡å»ºâ€çš„ç­‰ä»·è¿‘ä¼¼ã€‚

### 12.16 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆoriginCount æ¥æºè®¡æ•°è§’æ ‡ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/res/layout/item_search.xml` ä¸­ `bv_originCount` ä¸ `ExploreShowAdapter.kt` åˆ—è¡¨ä¿¡æ¯å±•ç¤ºã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/domain/models/search_result_entity.dart`ï¼šæ–°å¢ `originCount` å­—æ®µï¼ˆé»˜è®¤ `1`ï¼‰ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/domain/services/legado_search_service.dart`ï¼š
  - æœç´¢/å‘ç°èšåˆç»“æœæ”¹ä¸ºæŒ‰â€œä¹¦å+ä½œè€…ï¼ˆç¼ºä½œè€…å›é€€ä¹¦åï¼‰â€åˆå¹¶åŒåé¡¹ï¼›
  - ç»Ÿè®¡å»é‡åçš„æ¥æºæ•°ï¼Œå†™å…¥ `originCount`ï¼›
  - ä¿æŒé¦–ä¸ªæ¥æºä½œä¸ºè¯¦æƒ…å…¥å£æ¥æºï¼Œå…¼å®¹å½“å‰è¯¦æƒ…é“¾è·¯ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼šå½“ `originCount > 1` æ—¶å±•ç¤ºæ¥æºè§’æ ‡ï¼ˆ`xæº`ï¼‰ã€‚
- âœ… å·²æ‰©å±•æµ‹è¯• `test/features/discovery/legado_search_service_test.dart`ï¼š
  - æ–°å¢ `search` èšåˆæ¥æºè®¡æ•°ç”¨ä¾‹ï¼›
  - æ–°å¢ `explore` èšåˆæ¥æºè®¡æ•°ç”¨ä¾‹ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šå½“å‰ä»…å±•ç¤ºè®¡æ•°è§’æ ‡ï¼Œå°šæœªæä¾›â€œåŒåä¹¦æºå±•å¼€/æ¢æºåˆ—è¡¨â€äº¤äº’ã€‚

### 12.17 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆæ¥æºè§’æ ‡ç‚¹å‡»é€‰æºï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š`../legado/app/src/main/java/io/legado/app/ui/book/search/SearchAdapter.kt` çš„ `origins` èšåˆæ˜¾ç¤ºä¸ `item_search.xml` çš„æ¥æºè§’æ ‡è¯­ä¹‰ã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/domain/models/search_result_entity.dart`ï¼š
  - æ–°å¢ `SearchResultOriginEntity`ï¼Œæ‰¿è½½åŒåä¹¦çš„æ¥æºæ˜ç»†ï¼›
  - `SearchResultEntity` æ–°å¢ `origins` å­—æ®µï¼ˆä¸ `originCount` å¯¹åº”ï¼‰ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/domain/services/legado_search_service.dart`ï¼š
  - èšåˆåŒåç»“æœæ—¶åŒæ­¥ä¿ç•™æ¯ä¸ªæ¥æºçš„æ˜ç»†ï¼ˆ`sourceUrl/sourceName/bookUrl/...`ï¼‰ï¼›
  - å»é‡ç­–ç•¥ç»´æŒâ€œåŒä¸€æ¥æºä»…ä¿ç•™ä¸€æ¡æ˜ç»†â€ï¼Œå¹¶ç»§ç»­è¾“å‡º `originCount`ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - æ¥æºè§’æ ‡æ”¯æŒç‚¹å‡»ï¼›
  - å½“åŒåä¹¦æ¥æºæ•° > 1 æ—¶å¼¹å‡º `CupertinoActionSheet` ä¾›é€‰æ‹©æ¥æºï¼›
  - é€‰æ‹©åæŒ‰æ‰€é€‰æ¥æºæ‰“å¼€è¯¦æƒ…é¡µï¼ˆsource/bookUrl/cover/intro è·Ÿéšæ‰€é€‰æ¥æºï¼‰ã€‚
- âœ… å·²æ‰©å±•æµ‹è¯• `test/features/discovery/legado_search_service_test.dart`ï¼š
  - `search` ä¸ `explore` èšåˆç”¨ä¾‹æ–°å¢ `origins` æ˜ç»†æ–­è¨€ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šå½“å‰ä½¿ç”¨å¼¹å±‚é€‰æºåè¿›å…¥è¯¦æƒ…ï¼Œå°šæœªå®ç°â€œç»“æœé¡¹å†…ç›´æ¥å±•å¼€åŒåæ¥æºåˆ—è¡¨â€çš„é•¿åˆ—è¡¨äº¤äº’ã€‚

### 12.18 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆé€‰æºå¼¹å±‚ä¿¡æ¯å¢å¼ºï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½ï¼š
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceDialog.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceAdapter.kt`
  - `../legado/app/src/main/res/layout/item_change_source.xml`
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart` çš„æ¥æºé€‰æ‹©å¼¹å±‚ï¼š
  - æ¯ä¸ªæ¥æºé¡¹é™¤ `sourceName` å¤–ï¼Œè¿½åŠ å±•ç¤ºâ€œæœ€æ–°ç« èŠ‚ / å­—æ•°â€æ‘˜è¦ï¼ˆæœ‰å€¼æ‰æ˜¾ç¤ºï¼‰ï¼›
  - è‡ªåŠ¨æ ‡æ³¨â€œå½“å‰â€æ¥æºï¼Œå¹¶ä½œä¸ºé»˜è®¤åŠ¨ä½œæ ·å¼ï¼›
  - é€‰æ‹©æ¥æºåç»§ç»­æŒ‰æ‰€é€‰æ¥æºå‚æ•°è¿›å…¥è¯¦æƒ…é¡µã€‚
- âœ… ä¿æŒç°æœ‰è¡Œä¸ºï¼šåˆ—è¡¨å¡ç‰‡ç‚¹å‡»ä»èµ°é»˜è®¤æ¥æºï¼›ä»…ç‚¹å‡»æ¥æºè§’æ ‡æ—¶è§¦å‘é€‰æºå¼¹å±‚ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šå½“å‰ä»ä¸ºè½»é‡ `CupertinoActionSheet`ï¼Œæœªå®ç° legado æ¢æºé¡µä¸­çš„è¯„åˆ†ã€ç½®é¡¶/ç½®åº•ã€ç¦ç”¨ã€ç¼–è¾‘ç­‰æ·±åº¦ç®¡ç†æ“ä½œã€‚

### 12.19 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆæ¥æºé€‰æ‹©å‡çº§ä¸ºå¯æœç´¢åˆ—è¡¨ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½å¹¶å®Œæ•´è¯»å–ï¼š
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceDialog.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceAdapter.kt`
  - `../legado/app/src/main/res/layout/item_change_source.xml`
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - æ¥æºè§’æ ‡ç‚¹å‡»åï¼Œå¼¹å±‚ä» `ActionSheet` å‡çº§ä¸ºâ€œå¯æœç´¢ + å¯æ»šåŠ¨â€çš„æ¥æºåˆ—è¡¨é¢æ¿ï¼›
  - æ”¯æŒæŒ‰æ¥æºå/æ¥æºURL/æœ€æ–°ç« èŠ‚/å­—æ•°ç­›é€‰ï¼›
  - åˆ—è¡¨é¡¹å±•ç¤ºæ¥æºå + æ‘˜è¦ï¼ˆæœ€æ–°ç« èŠ‚ã€å­—æ•°ï¼‰ï¼Œå¹¶æ ‡æ³¨â€œå½“å‰â€æ¥æºï¼›
  - é€‰æ‹©åç»§ç»­æŒ‰æ‰€é€‰æ¥æºè¿›å…¥è¯¦æƒ…é¡µã€‚
- âœ… ä¿æŒäº¤äº’è¾¹ç•Œï¼š
  - å¡ç‰‡ä¸»ä½“ç‚¹å‡»ä»èµ°é»˜è®¤æ¥æºè¯¦æƒ…ï¼›
  - ä»…æ¥æºè§’æ ‡å…¥å£è§¦å‘æ¥æºåˆ—è¡¨é€‰æ‹©ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šå½“å‰æ¥æºåˆ—è¡¨æœªå®ç° legado æ¢æºé¡µä¸­çš„è¯„åˆ†ã€ç½®é¡¶/ç½®åº•ã€ç¦ç”¨ã€ç¼–è¾‘ä¸æ¢æºåç›®å½•åŠ è½½æµç¨‹ï¼Œä»…æä¾›è½»é‡æ¥æºé€‰æ‹©èƒ½åŠ›ã€‚

### 12.20 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆæ¥æºé•¿æŒ‰ç®¡ç†ï¼šç½®é¡¶/ç½®åº•/ç¦ç”¨/åˆ é™¤ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½å¹¶å®Œæ•´è¯»å–ï¼š
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceDialog.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceAdapter.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceViewModel.kt`
  - `../legado/app/src/main/java/io/legado/app/data/dao/BookSourceDao.kt`
- âœ… å·²æ‰©å±•ä¹¦æºä»“å‚¨èƒ½åŠ›ï¼š
  - `BookSourceRepository` æ–°å¢ `setBookSourceEnabled / moveBookSourceToTop / moveBookSourceToBottom`ï¼›
  - `BookSourceLocalRepository` å·²å®ç°ä¸Šè¿°æ“ä½œï¼›
  - `AppDatabase` æ–°å¢ `setBookSourceEnabled / getBookSourceMinOrder / getBookSourceMaxOrder / updateBookSourceOrder`ã€‚
- âœ… å·²ä¿®æ­£æ’åºè¯­ä¹‰ï¼š`getBookSources/watchBookSources` æ”¹ä¸ºæŒ‰ `customOrder` æ’åºï¼ˆå¯¹é½ legado `BookSourceDao`ï¼‰ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - æ¥æºåˆ—è¡¨é¡¹æ”¯æŒé•¿æŒ‰ï¼›
  - é•¿æŒ‰åå¼¹å‡ºæ¥æºç®¡ç†èœå•ï¼ˆç½®é¡¶/ç½®åº•/ç¦ç”¨/åˆ é™¤ï¼‰ï¼›
  - æ“ä½œåè‡ªåŠ¨æŒ‰é¦–å±é‡è½½å‘ç°ç»“æœï¼Œä¿è¯æ’åº/å¯è§æ€§å³æ—¶ç”Ÿæ•ˆï¼›
  - å¯¹é«˜é£é™©æ“ä½œè¡¥å……ç¡®è®¤å¼¹çª—ä¸å¤±è´¥æç¤ºã€‚
- âœ… å·²è¡¥å……æµ‹è¯•ï¼š
  - `test/core/storage/app_database_test.dart` æ–°å¢ `customOrder` æ’åºä¸ç½®é¡¶/ç½®åº•å›å½’ç”¨ä¾‹ï¼›
  - ä¸‰ä¸ªå†…å­˜ä»“å‚¨æµ‹è¯•æ¡©å‡å·²å¯¹é½æ–°æ¥å£ä¸æ’åºè¡Œä¸ºã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼š
  - å½“å‰é•¿æŒ‰èœå•å°šæœªå®ç°â€œç¼–è¾‘ä¹¦æºâ€å…¥å£ï¼ˆä¾èµ–åç»­ä¹¦æºç®¡ç†é¡µï¼‰ï¼›
  - å°šæœªå®ç°æ¥æºè¯„åˆ†ï¼ˆèµ/è¸©ï¼‰ä¸æŒ‰è¯„åˆ†æ’åºï¼Œä»…ä¿ç•™ `customOrder` è¯­ä¹‰ã€‚

### 12.21 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆæ¥æºè¯„åˆ† + æ’åºå¯¹é½ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½å¹¶å®Œæ•´è¯»å–ï¼š
  - `../legado/app/src/main/java/io/legado/app/help/config/SourceConfig.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceAdapter.kt`
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceViewModel.kt`
- âœ… å·²æ–°å¢ `lib/features/source_management/data/local/source_score_local_repository.dart`ï¼š
  - æŒ‰ legado è¯­ä¹‰ç»´æŠ¤â€œå•ä¹¦å•æºè¯„åˆ†ï¼ˆ-1/0/1ï¼‰â€ä¸â€œä¹¦æºç´¯è®¡è¯„åˆ†â€ï¼›
  - åŒä¸€ä¹¦å†æ¬¡è¯„åˆ†æŒ‰å·®å€¼æ›´æ–°æ¥æºæ€»åˆ†ï¼ˆä¸ `SourceConfig.setBookScore` ä¸€è‡´ï¼‰ã€‚
- âœ… å·²æ‰©å±• `lib/features/discovery/presentation/explore_results_page.dart` æ¥æºå¼¹å±‚ï¼š
  - æ¯ä¸ªæ¥æºé¡¹æ–°å¢â€œğŸ‘/ğŸ‘â€è¯„åˆ†å…¥å£ï¼ˆå¯äºŒæ¬¡ç‚¹å‡»å›åˆ° 0ï¼‰ï¼›
  - å±•ç¤ºâ€œè¯„åˆ† / ä¹¦æºè¯„åˆ†â€ï¼›
  - æ’åºè§„åˆ™å¯¹é½ legadoï¼š`ä¹¦ç±è¯„åˆ†(desc) -> ä¹¦æºè¯„åˆ†(desc) -> customOrder(asc)`ã€‚
- âœ… å·²è¡¥å……æ¸…ç†é€»è¾‘ï¼šç¦ç”¨/åˆ é™¤æ¥æºæ—¶åŒæ­¥æ¸…ç†è¯¥æ¥æºè¯„åˆ†æ•°æ®ï¼Œé¿å…è„æ•°æ®æ®‹ç•™ã€‚
- âœ… å·²æ–°å¢æµ‹è¯• `test/features/source_management/source_score_local_repository_test.dart`ï¼š
  - è¦†ç›–é¦–æ¬¡è¯„åˆ†ã€é‡å¤æ”¹åˆ†å·®å€¼æ›´æ–°ã€æ¸…ç†æ¥æºè¯„åˆ†ä¸‰ç±»æ ¸å¿ƒåœºæ™¯ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼š
  - å½“å‰è¯„åˆ†å…¥å£ç½®äºæ¥æºé€‰æ‹©å¼¹å±‚å†…ï¼Œå°šæœªåœ¨åˆ—è¡¨é¡¹å·¦ä¾§åšå®Œå…¨åŒæ„å›¾æ ‡å¸ƒå±€ï¼ˆåŠŸèƒ½è¯­ä¹‰å·²ä¸€è‡´ï¼‰ã€‚

### 12.22 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆè¯„åˆ†å›¾æ ‡å¸ƒå±€è¿›ä¸€æ­¥è´´è¿‘ legadoï¼‰

- âœ… legado å¯¹ç…§å·²å¤æ ¸å¹¶å®Œæ•´è¯»å–ï¼š
  - `../legado/app/src/main/res/layout/item_change_source.xml`
  - `../legado/app/src/main/java/io/legado/app/ui/book/changesource/ChangeBookSourceAdapter.kt`
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart` æ¥æºåˆ—è¡¨é¡¹ï¼š
  - è¯„åˆ†å…¥å£ä»â€œè¡Œå†…æ–‡æœ¬æŒ‰é’®â€æ”¹ä¸ºâ€œå·¦ä¾§ä¸Šä¸‹åŒå›¾æ ‡â€å¸ƒå±€ï¼›
  - å›¾æ ‡è¯­ä¹‰ä¸é¢œè‰²å¯¹åº” legadoï¼šä¸Šæ–¹ç‚¹èµï¼ˆçº¢ï¼‰ã€ä¸‹æ–¹ç‚¹è¸©ï¼ˆè“ï¼‰ï¼Œæ¿€æ´»æ€/éæ¿€æ´»æ€åŒºåˆ†æ˜æ˜¾ï¼›
  - ç‚¹å‡»é€»è¾‘ä¿æŒä¸å˜ï¼š`1 <-> 0`ã€`-1 <-> 0`ï¼Œå¹¶åœ¨å¼¹å±‚å†…å³æ—¶é‡æ’ã€‚
- âœ… ä¿æŒæ—¢æœ‰äº¤äº’ï¼šæ¥æºé¡¹ç‚¹å‡»è¿›å…¥è¯¦æƒ…ã€é•¿æŒ‰ä»å¯è¿›å…¥æ¥æºç®¡ç†èœå•ã€‚
- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼šå½“å‰ä½¿ç”¨ Cupertino å›¾æ ‡é›†è¿‘ä¼¼ `ic_praise` è§†è§‰ï¼Œæœªå¼•å…¥ legado åŸå§‹çŸ¢é‡èµ„æºã€‚

### 12.23 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆæ¥å…¥ legado åŒæ¬¾çŸ¢é‡è¯„åˆ†å›¾æ ‡ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½å¹¶å®Œæ•´è¯»å–ï¼š
  - `../legado/app/src/main/res/drawable/ic_praise.xml`
  - `../legado/app/src/main/res/layout/item_change_source.xml`
- âœ… å·²æ–°å¢ Flutter ä¾§å›¾æ ‡èµ„äº§ï¼š`assets/icons/ic_praise.svg`ï¼ˆç”± legado `vector pathData` è½¬æ¢ï¼‰ã€‚
- âœ… å·²æ›´æ–° `pubspec.yaml`ï¼š
  - ä¾èµ–æ–°å¢ `flutter_svg`ï¼›
  - èµ„äº§æ³¨å†Œ `assets/icons/ic_praise.svg`ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - ç‚¹èµå›¾æ ‡æ”¹ä¸º `ic_praise.svg`ï¼›
  - ç‚¹è¸©å›¾æ ‡é‡‡ç”¨åŒä¸€ SVG é€šè¿‡ `rotateX(pi)` ç¿»è½¬å¤ç”¨ï¼ˆä¸ legado `rotationX=180` è¯­ä¹‰ä¸€è‡´ï¼‰ï¼›
  - é¢œè‰²ä»ä¿æŒâ€œçº¢èµè“è¸© + æ¿€æ´»/éæ¿€æ´»â€è§„åˆ™ã€‚
- âœ… å·²éªŒè¯ï¼š`flutter analyze` ä¸å‘ç°åŸŸå›å½’æµ‹è¯•é€šè¿‡ã€‚

### 12.24 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆå½“å‰æ¥æºæ ‡è¯†æ›¿æ¢ä¸º legado å‹¾é€‰å›¾æ ‡ï¼‰

- âœ… legado å¯¹ç…§å·²è¡¥é½å¹¶å®Œæ•´è¯»å–ï¼š
  - `../legado/app/src/main/res/drawable/ic_check.xml`
  - `../legado/app/src/main/res/layout/item_change_source.xml`
- âœ… å·²æ–°å¢ Flutter ä¾§å›¾æ ‡èµ„äº§ï¼š`assets/icons/ic_check.svg`ï¼ˆç”± legado `vector pathData` è½¬æ¢ï¼‰ã€‚
- âœ… å·²æ›´æ–° `pubspec.yaml` èµ„äº§æ³¨å†Œï¼š`assets/icons/ic_check.svg`ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - æ¥æºåˆ—è¡¨ä¸­â€œå½“å‰â€æ–‡æœ¬å·²æ›¿æ¢ä¸ºå³ä¾§å‹¾é€‰å›¾æ ‡ï¼ˆ`ic_check.svg`ï¼‰ï¼›
  - è§†è§‰è¯­ä¹‰æ›´è´´è¿‘ legado çš„ `iv_checked`ã€‚
- âœ… å·²éªŒè¯ï¼š`flutter analyze` ä¸å‘ç°åŸŸå›å½’æµ‹è¯•é€šè¿‡ã€‚

### 12.25 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆå½“å‰æ¥æºå‹¾é€‰åŒºå°ºå¯¸ä¸å ä½å¯¹é½ï¼‰

- âœ… legado å¯¹ç…§å·²å¤æ ¸ï¼š`item_change_source.xml` ä¸­ `iv_checked` ä¸º `40dp x 40dp`ï¼Œå¹¶åœ¨æœªé€‰ä¸­æ—¶ä¿æŒå ä½ï¼ˆ`invisible`ï¼‰ã€‚
- âœ… å·²æ”¹é€  `lib/features/discovery/presentation/explore_results_page.dart`ï¼š
  - å³ä¾§â€œå½“å‰æ¥æºâ€åŒºåŸŸæ”¹ä¸ºå›ºå®š `40x40` å®¹å™¨ï¼›
  - é€‰ä¸­æ—¶æ˜¾ç¤º `24x24` å‹¾é€‰å›¾æ ‡ï¼Œæœªé€‰ä¸­æ—¶ä¿ç•™ç©ºå ä½ï¼Œé¿å…è¡Œå†…æ–‡å­—æŠ–åŠ¨ã€‚
- âœ… å·²éªŒè¯ï¼š`dart format`ã€`flutter analyze`ã€å‘ç°åŸŸå›å½’æµ‹è¯•é€šè¿‡ã€‚

### 12.26 æœ¬è½®è¿½åŠ å®Œæˆï¼ˆä¸»æµç¨‹ç»Ÿä¸€æ‰§è¡Œå™¨ + æ ¸å¿ƒé“¾è·¯å¯¹é½ï¼‰

- âœ… legado å¯¹ç…§å·²å®Œæ•´è¯»å–å¹¶æç‚¼å…±åŒè¯­ä¹‰ï¼š
  - `../legado/app/src/main/java/io/legado/app/model/webBook/WebBook.kt`
  - `../legado/app/src/main/java/io/legado/app/model/webBook/BookList.kt`
  - `../legado/app/src/main/java/io/legado/app/model/webBook/BookInfo.kt`
  - `../legado/app/src/main/java/io/legado/app/model/webBook/BookChapterList.kt`
  - `../legado/app/src/main/java/io/legado/app/model/webBook/BookContent.kt`
  - `../legado/app/src/main/java/io/legado/app/model/webBook/SearchModel.kt`
- âœ… å·²æ–°å¢ç»Ÿä¸€è§„åˆ™æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š`lib/legado/model/web_book/rule_execution_context.dart`
  - ç»Ÿä¸€ URL æ¨¡æ¿æ›¿æ¢ï¼ˆ`{{key}}/{{page}}` ç­‰ï¼‰ä¸ç›¸å¯¹é“¾æ¥è§£æï¼›
  - ç»Ÿä¸€ header JSON è§£æï¼›
  - ç»Ÿä¸€è¯·æ±‚æ‰§è¡Œè¾“å‡ºï¼ˆ`requestUrl/responseUrl/body/redirected`ï¼‰ã€‚
- âœ… å·²æ‰©å±•ç½‘ç»œç½‘å…³ï¼š`lib/core/network/legado_http_gateway.dart`
  - æ–°å¢ `getResponse(...)` è¿”å›æœ€ç»ˆ URL ä¸é‡å®šå‘æ ‡è®°ï¼›
  - æ—§ `get(...)` ç»§ç»­ä¿ç•™ï¼Œå…¼å®¹ç°æœ‰è°ƒç”¨ã€‚
- âœ… å·²æ¥å…¥ä¸»é“¾è·¯ï¼š`lib/legado/model/web_book/web_book.dart`
  - `searchBook/exploreBook/getBookInfo/getChapterList/getContent` ç»Ÿä¸€èµ°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼›
  - æœç´¢æ–°å¢ `bookUrlPattern` å‘½ä¸­è¯¦æƒ…é¡µåˆ†æ”¯ï¼ˆæŒ‰è¯¦æƒ…è§„åˆ™è¿”å›å•ä¹¦ï¼‰ï¼›
  - `ruleToc` æ—  `url` æ—¶ï¼Œ`tocUrl` å›é€€åŸºå‡†æ”¹ä¸º `bookUrl`ï¼ˆå¯¹é½ legado ç›®å½•æŠ“å–è¯­ä¹‰ï¼‰ã€‚
- âœ… å·²è¡¥å……æµ‹è¯•ï¼š
  - `test/core/network/legado_http_gateway_test.dart`
  - `test/legado/model/web_book/rule_execution_context_test.dart`
  - `test/features/discovery/legado_search_service_test.dart`ï¼ˆæ–°å¢è¯¦æƒ…é¡µæœç´¢åˆ†æ”¯ï¼‰
  - `test/features/reader/legado_reader_service_test.dart`ï¼ˆæ–°å¢ç›¸å¯¹ `tocUrl` å›é€€ï¼‰
- âœ… å·²éªŒè¯ï¼š
  - `flutter analyze lib/core/network/legado_http_gateway.dart lib/legado/model/web_book/rule_execution_context.dart lib/legado/model/web_book/web_book.dart`
  - `flutter test test/core/network/legado_http_gateway_test.dart test/legado/model/web_book/rule_execution_context_test.dart test/features/discovery/legado_search_service_test.dart test/features/reader/legado_reader_service_test.dart`

- âš ï¸ ä¸ legado çš„å·²çŸ¥å·®å¼‚ï¼ˆä»å¾…æ¨è¿›ï¼‰ï¼š
  - å°šæœªæ¥å…¥ `loginCheckJs`ã€`preUpdateJs`ã€`content.webJs/sourceRegex` JS æ‰§è¡Œé“¾è·¯ï¼›
  - å°šæœªå®ç°ç›®å½•/æ­£æ–‡å¤šé¡µæŠ“å–ä¸å¹¶å‘åˆ†é¡µï¼ˆ`nextTocUrl/nextContentUrl` å…¨é‡è¯­ä¹‰ï¼‰ï¼›
  - å°šæœªå®ç° `RuleData/Chapter` çº§ä¸Šä¸‹æ–‡å˜é‡åœ¨ç»Ÿä¸€æ‰§è¡Œå™¨ä¸­çš„å®Œæ•´é€ä¼ ã€‚
